var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var n;for(n=0;n<t.length&&(!t[n]||!e(t[n],n,t));n+=1);}}function eachReverse(t,e){if(t){var n;for(n=t.length-1;n>-1&&(!t[n]||!e(t[n],n,t));n-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var n;for(n in t)if(hasProp(t,n)&&e(t[n],n))break}function mixin(t,e,n,i){return e&&eachProp(e,function(e,o){(n||!hasProp(t,o))&&(i&&"string"!=typeof e?(t[o]||(t[o]={}),mixin(t[o],e,n,i)):t[o]=e)}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,n,i){var o=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return o.requireType=t,o.requireModules=i,n&&(o.originalError=n),o}function newContext(t){function e(t){var e,n;for(e=0;t[e];e+=1)if(n=t[e],"."===n)t.splice(e,1),e-=1;else if(".."===n){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function n(t,n,i){var o,r,s,a,u,c,h,l,d,f,p,m=n&&n.split("/"),g=m,y=S.map,b=y&&y["*"];if(t&&"."===t.charAt(0)&&(n?(g=getOwn(S.pkgs,n)?m=[n]:m.slice(0,m.length-1),t=g.concat(t.split("/")),e(t),r=getOwn(S.pkgs,o=t[0]),t=t.join("/"),r&&t===o+"/"+r.main&&(t=o)):0===t.indexOf("./")&&(t=t.substring(2))),i&&y&&(m||b)){for(a=t.split("/"),u=a.length;u>0;u-=1){if(h=a.slice(0,u).join("/"),m)for(c=m.length;c>0;c-=1)if(s=getOwn(y,m.slice(0,c).join("/")),s&&(s=getOwn(s,h))){l=s,d=u;break}if(l)break;!f&&b&&getOwn(b,h)&&(f=getOwn(b,h),p=u)}!l&&f&&(l=f,d=p),l&&(a.splice(0,d,l),t=a.join("/"))}return t}function i(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===w.contextName?(e.parentNode.removeChild(e),!0):void 0})}function o(t){var e=getOwn(S.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),w.require.undef(t),w.require([t]),!0):void 0}function r(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function s(t,e,i,o){var s,a,u,c,h=null,l=e?e.name:null,d=t,f=!0,p="";return t||(f=!1,t="_@r"+(j+=1)),c=r(t),h=c[0],t=c[1],h&&(h=n(h,l,o),a=getOwn(k,h)),t&&(h?p=a&&a.normalize?a.normalize(t,function(t){return n(t,l,o)}):n(t,l,o):(p=n(t,l,o),c=r(p),h=c[0],p=c[1],i=!0,s=w.nameToUrl(p))),u=!h||a||i?"":"_unnormalized"+(I+=1),{prefix:h,name:p,parentMap:e,unnormalized:!!u,url:s,originalName:d,isDefine:f,id:(h?h+"!"+p:p)+u}}function a(t){var e=t.id,n=getOwn(P,e);return n||(n=P[e]=new w.Module(t)),n}function u(t,e,n){var i=t.id,o=getOwn(P,i);!hasProp(k,i)||o&&!o.defineEmitComplete?(o=a(t),o.error&&"error"===e?n(o.error):o.on(e,n)):"defined"===e&&n(k[i])}function c(t,e){var n=t.requireModules,i=!1;e?e(t):(each(n,function(e){var n=getOwn(P,e);n&&(n.error=t,n.events.error&&(i=!0,n.emit("error",t)))}),i||req.onError(t))}function h(){globalDefQueue.length&&(apsp.apply(M,[M.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function l(t){delete P[t],delete O[t]}function d(t,e,n){var i=t.map.id;t.error?t.emit("error",t.error):(e[i]=!0,each(t.depMaps,function(i,o){var r=i.id,s=getOwn(P,r);!s||t.depMatched[o]||n[r]||(getOwn(e,r)?(t.defineDep(o,k[r]),t.check()):d(s,e,n))}),n[i]=!0)}function f(){var t,e,n,r,s=1e3*S.waitSeconds,a=s&&w.startTime+s<(new Date).getTime(),u=[],h=[],l=!1,p=!0;if(!b){if(b=!0,eachProp(O,function(n){if(t=n.map,e=t.id,n.enabled&&(t.isDefine||h.push(n),!n.error))if(!n.inited&&a)o(e)?(r=!0,l=!0):(u.push(e),i(e));else if(!n.inited&&n.fetched&&t.isDefine&&(l=!0,!t.prefix))return p=!1}),a&&u.length)return n=makeError("timeout","Load timeout for modules: "+u,null,u),n.contextName=w.contextName,c(n);p&&each(h,function(t){d(t,{},{})}),a&&!r||!l||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,f()},50)),b=!1}}function p(t){hasProp(k,t[0])||a(s(t[0],null,!0)).init(t[1],t[2])}function m(t,e,n,i){t.detachEvent&&!isOpera?i&&t.detachEvent(i,e):t.removeEventListener(n,e,!1)}function g(t){var e=t.currentTarget||t.srcElement;return m(e,w.onScriptLoad,"load","onreadystatechange"),m(e,w.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function y(){var t;for(h();M.length;){if(t=M.shift(),null===t[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));p(t)}}var b,v,w,x,C,S={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},P={},O={},A={},M=[],k={},E={},j=1,I=1;return x={require:function(t){return t.require?t.require:t.require=w.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?t.exports:t.exports=k[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){var e,n=getOwn(S.pkgs,t.map.id);return e=n?getOwn(S.config,t.map.id+"/"+n.main):getOwn(S.config,t.map.id),e||{}},exports:k[t.map.id]}}},v=function(t){this.events=getOwn(A,t.id)||{},this.map=t,this.shim=getOwn(S.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},v.prototype={init:function(t,e,n,i){i=i||{},this.inited||(this.factory=e,n?this.on("error",n):this.events.error&&(n=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var t=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;E[t]||(E[t]=!0,w.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,n=this.map.id,i=this.depExports,o=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=w.execCb(n,r,i,o)}catch(s){t=s}else o=w.execCb(n,r,i,o);if(this.map.isDefine&&(e=this.module,e&&void 0!==e.exports&&e.exports!==this.exports?o=e.exports:void 0===o&&this.usingExports&&(o=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",c(this.error=t)}else o=r;this.exports=o,this.map.isDefine&&!this.ignore&&(k[n]=o,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),l(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,i=s(t.prefix);this.depMaps.push(i),u(i,"defined",bind(this,function(i){var o,r,h,d=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,p=w.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(d=i.normalize(d,function(t){return n(t,f,!0)})||""),r=s(t.prefix+"!"+d,this.map.parentMap),u(r,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),h=getOwn(P,r.id),void(h&&(this.depMaps.push(r),this.events.error&&h.on("error",bind(this,function(t){this.emit("error",t)})),h.enable()))):(o=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),o.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(P,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&l(t.map.id)}),c(t)}),o.fromText=bind(this,function(n,i){var r=t.name,u=s(r),h=useInteractive;i&&(n=i),h&&(useInteractive=!1),a(u),hasProp(S.config,e)&&(S.config[r]=S.config[e]);try{req.exec(n)}catch(l){return c(makeError("fromtexteval","fromText eval for "+e+" failed: "+l,l,[e]))}h&&(useInteractive=!0),this.depMaps.push(u),w.completeLoad(r),p([r],o)}),void i.load(t.name,p,o,S))})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){O[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var n,i,o;if("string"==typeof t){if(t=s(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,o=getOwn(x,t.id))return void(this.depExports[e]=o(this));this.depCount+=1,u(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&u(t,"error",bind(this,this.errback))}n=t.id,i=P[n],hasProp(x,n)||!i||i.enabled||w.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(P,t.id);e&&!e.enabled&&w.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var n=this.events[t];n||(n=this.events[t]=[]),n.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},w={config:S,contextName:t,registry:P,defined:k,urlFetched:E,defQueue:M,Module:v,makeModuleMap:s,nextTick:req.nextTick,onError:c,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=S.pkgs,n=S.shim,i={paths:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?"map"===e?(S.map||(S.map={}),mixin(S[e],t,!0,!0)):mixin(S[e],t,!0):S[e]=t}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=w.makeShimExports(t)),n[e]=t}),S.shim=n),t.packages&&(each(t.packages,function(t){var n;t="string"==typeof t?{name:t}:t,n=t.location,e[t.name]={name:t.name,location:n||t.name,main:(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),S.pkgs=e),eachProp(P,function(t,e){t.inited||t.map.unnormalized||(t.map=s(e))}),(t.deps||t.callback)&&w.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,o){function r(n,i,u){var h,l,d;return o.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?c(makeError("requireargs","Invalid require call"),u):e&&hasProp(x,n)?x[n](P[e.id]):req.get?req.get(w,n,e,r):(l=s(n,e,!1,!0),h=l.id,hasProp(k,h)?k[h]:c(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(y(),w.nextTick(function(){y(),d=a(s(null,e)),d.skipMap=o.skipMap,d.init(n,i,u,{enabled:!0}),f()}),r)}return o=o||{},mixin(r,{isBrowser:isBrowser,toUrl:function(t){var i,o=t.lastIndexOf("."),r=t.split("/")[0],s="."===r||".."===r;return-1!==o&&(!s||o>1)&&(i=t.substring(o,t.length),t=t.substring(0,o)),w.nameToUrl(n(t,e&&e.id,!0),i,!0)},defined:function(t){return hasProp(k,s(t,e,!1,!0).id)},specified:function(t){return t=s(t,e,!1,!0).id,hasProp(k,t)||hasProp(P,t)}}),e||(r.undef=function(t){h();var n=s(t,e,!0),o=getOwn(P,t);i(t),delete k[t],delete E[n.url],delete A[t],o&&(o.events.defined&&(A[t]=o.events),l(t))}),r},enable:function(t){var e=getOwn(P,t.id);e&&a(t).enable()},completeLoad:function(t){var e,n,i,r=getOwn(S.shim,t)||{},s=r.exports;for(h();M.length;){if(n=M.shift(),null===n[0]){if(n[0]=t,e)break;e=!0}else n[0]===t&&(e=!0);p(n)}if(i=getOwn(P,t),!e&&!hasProp(k,t)&&i&&!i.inited){if(!(!S.enforceDefine||s&&getGlobal(s)))return o(t)?void 0:c(makeError("nodefine","No define call for "+t,null,[t]));p([t,r.deps||[],r.exportsFn])}f()},nameToUrl:function(t,e,n){var i,o,r,s,a,u,c,h,l;if(req.jsExtRegExp.test(t))h=t+(e||"");else{for(i=S.paths,o=S.pkgs,a=t.split("/"),u=a.length;u>0;u-=1){if(c=a.slice(0,u).join("/"),r=getOwn(o,c),l=getOwn(i,c)){isArray(l)&&(l=l[0]),a.splice(0,u,l);break}if(r){s=t===r.name?r.location+"/"+r.main:r.location,a.splice(0,u,s);break}}h=a.join("/"),h+=e||(/^data\:|\?/.test(h)||n?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+h}return S.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+S.urlArgs):h},load:function(t,e){req.load(w,t,e)},execCb:function(t,e,n,i){return e.apply(i,n)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=g(t);w.completeLoad(e.id)}},onScriptError:function(t){var e=g(t);return o(e.id)?void 0:c(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,n,i){var o,r,s=defContextName;return isArray(t)||"string"==typeof t||(r=t,isArray(e)?(t=e,e=n,n=i):t=[]),r&&r.context&&(s=r.context),o=getOwn(contexts,s),o||(o=contexts[s]=req.s.newContext(s)),r&&o.configure(r),o.require(t,e,n)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,n){var i,o=t&&t.config||{};if(isBrowser)return i=req.createNode(o,e,n),i.setAttribute("data-requirecontext",t.contextName),i.setAttribute("data-requiremodule",e),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",t.onScriptLoad,!1),i.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",t.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),t.completeLoad(e)}catch(r){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+n,r,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,n){var i,o;"string"!=typeof t&&(n=e,e=t,t=null),isArray(e)||(n=e,e=null),!e&&isFunction(n)&&(e=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,n){e.push(n)}),e=(1===n.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(t||(t=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([t,e,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(t,e){"use strict";function n(t){return document.createElement(t)}function i(t,e){for(var n in e)try{t.style[n]=e[n]}catch(i){}return t}function o(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function r(t,e){if("array"!==o(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1}function s(){var t=arguments;for(var e in t[1])if(t[1].hasOwnProperty(e))switch(o(t[1][e])){case"object":t[0][e]=s({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return t.length>2?s.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function a(t,e,n){var i,o,r,s,a,c,h,l,d;return s=.5>=n?n*(1+e):n+e-n*e,0===s?"#000":(a=2*n-s,c=(s-a)/s,t=6*t,h=Math.floor(t),l=t-h,d=s*c*l,0===h||6===h?(i=s,o=a+d,r=a):1===h?(i=s-d,o=s,r=a):2===h?(i=a,o=s,r=a+d):3===h?(i=a,o=s-d,r=s):4===h?(i=a+d,o=a,r=s):(i=s,o=a,r=s-d),"#"+u(i)+u(o)+u(r))}function u(t){return t=Math.round(255*t).toString(16),1===t.length?"0"+t:t}function c(t,e,n,i){t.addEventListener?t[i?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[i?"detachEvent":"attachEvent"]("on"+e,n)}function h(t,u){function y(){for(T=R.history;T--;)X[T]=0===T?L.fps:X[T-1],Y[T]=0===T?L.duration:Y[T-1]}function b(t,e,n,i){return k[0|t][Math.round(Math.min((e-n)/(i-n)*q,q))]}function v(){B.legend.fps!==V&&(B.legend.fps=V,B.legend[p]=V?"FPS":"ms"),H=V?L.fps:L.duration,B.count[p]=H>999?"999+":H.toFixed(H>99?0:R.decimals)}function w(){if(E=l(),G<E-R.threshold&&(L.fps-=L.fps/Math.max(1,60*R.smoothing/R.interval),L.duration=1e3/L.fps),y(),v(),R.heat){if(F.length)for(T=F.length;T--;)F[T].el.style[M[F[T].name].heatOn]=V?b(M[F[T].name].heatmap,L.fps,0,R.maxFps):b(M[F[T].name].heatmap,L.duration,R.threshold,0);if(B.graph&&M.column.heatOn)for(T=N.length;T--;)N[T].style[M.column.heatOn]=V?b(M.column.heatmap,X[T],0,R.maxFps):b(M.column.heatmap,Y[T],R.threshold,0)}if(B.graph)for(D=0;D<R.history;D++)N[D].style.height=(V?X[D]?Math.round(_/R.maxFps*Math.min(X[D],R.maxFps)):0:Y[D]?Math.round(_/R.threshold*Math.min(Y[D],R.threshold)):0)+"px"}function x(){R.interval<20?(j=f(x),w()):(j=setTimeout(x,R.interval),I=f(w))}function C(t){t=t||window.event,t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),L.toggle()}function S(){R.toggleOn&&c(B.container,R.toggleOn,C,1),t.removeChild(B.container)}function P(){if(M=h.theme[R.theme],k=M.compiledHeatmaps||[],!k.length&&M.heatmaps.length){for(D=0;D<M.heatmaps.length;D++)for(k[D]=[],T=0;q>=T;T++)k[D][T]=a(.33/q*T,M.heatmaps[D].saturation,M.heatmaps[D].lightness);M.compiledHeatmaps=k}}function O(){B.container&&S(),P(),B.container=i(n("div"),M.container),B.count=B.container.appendChild(i(n("div"),M.count)),B.legend=B.container.appendChild(i(n("div"),M.legend)),B.graph=R.graph?B.container.appendChild(i(n("div"),M.graph)):0,F.length=0;for(var e in B)B[e]&&M[e].heatOn&&F.push({name:e,el:B[e]});if(N.length=0,B.graph)for(B.graph.style.width=R.history*M.column.width+(R.history-1)*M.column.spacing+"px",T=0;T<R.history;T++)N[T]=B.graph.appendChild(i(n("div"),M.column)),N[T].style.position="absolute",N[T].style.bottom=0,N[T].style.right=T*M.column.width+T*M.column.spacing+"px",N[T].style.width=M.column.width+"px",N[T].style.height="0px";A(),v(),t.appendChild(B.container),B.graph&&(_=B.graph.clientHeight),R.toggleOn&&("click"===R.toggleOn&&(B.container.style.cursor="pointer"),c(B.container,R.toggleOn,C))}function A(){i(B.container,R)}"object"===o(t)&&t.nodeType===e&&(u=t,t=document.body),t||(t=document.body);var M,k,E,j,I,_,H,T,D,L=this,R=s({},h.defaults,u||{}),B={},N=[],q=100,F=[],W=0,z=R.threshold,U=0,G=l()-z,X=[],Y=[],V="fps"===R.show;L.options=R,L.fps=0,L.duration=0,L.isPaused=0,L.tickStart=function(){U=l()},L.tick=function(){E=l(),W=E-G,z+=(W-z)/R.smoothing,L.fps=1e3/z,L.duration=G>U?z:E-U,G=E},L.pause=function(){return j&&(L.isPaused=1,clearTimeout(j),d(j),d(I),j=I=0),L},L.resume=function(){return j||(L.isPaused=0,x()),L},L.set=function(t,e){return R[t]=e,V="fps"===R.show,-1!==r(t,m)&&O(),-1!==r(t,g)&&A(),L},L.showDuration=function(){return L.set("show","ms"),L},L.showFps=function(){return L.set("show","fps"),L},L.toggle=function(){return L.set("show",V?"ms":"fps"),L},L.hide=function(){return L.pause(),B.container.style.display="none",L},L.show=function(){return L.resume(),B.container.style.display="block",L},L.destroy=function(){L.pause(),S(),L.tick=L.tickStart=function(){}},function(){O(),x()}()}var l;!function(){var e=t.performance;if(e&&(e.now||e.webkitNow)){var n=e.now?"now":"webkitNow";l=e[n].bind(e)}else l=function(){return+new Date}}();var d=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,f=t.requestAnimationFrame;!function(){for(var e=["moz","webkit","o"],n=0,i=0,o=e.length;o>i&&!d;++i)d=t[e[i]+"CancelAnimationFrame"]||t[e[i]+"CancelRequestAnimationFrame"],f=d&&t[e[i]+"RequestAnimationFrame"];d||(f=function(e){var i=l(),o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(function(){e(i+o)},o)},d=function(t){clearTimeout(t)})}();var p="string"===o(document.createElement("div").textContent)?"textContent":"innerText";h.extend=s,window.FPSMeter=h,h.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var m=["toggleOn","theme","heat","graph","history"],g=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t,e){"use strict";e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),function(){"use strict";var t=!1,e=[],n=window.requirejs,i=window.require,o=window.define,r={require:i,define:function(){var n=arguments[0];t&&e.push(n),o.apply(this,arguments)},refresh:function(){var t=0;for(t=0;t<e.length;++t)n.undef(e[t])},watch:function(){t=!0}};window.bento=window.bento||r}(),bento.define("audia",[],function(){var t=null;"function"==typeof AudioContext?t=new AudioContext:window.webkitAudioContext&&(t=new webkitAudioContext);var e,n=Boolean(t),i=0,o={},r=function(t){var e=++i;return o[e]=t,e},s=function(t,e,n){return Math.min(Math.max(Number(t),e),n)};if(n){var a={},u=function(e,n){var i=function(t){t.duration!==e._duration&&(e._duration=t.duration,e.dispatchEvent("durationchange")),e.dispatchEvent("canplay"),e.dispatchEvent("canplaythrough"),e.dispatchEvent("load"),e._autoplay&&e.play(),e._onload&&e.onload()};if(n in a)i(a[n]);else{var o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=function(){t.decodeAudioData(o.response,function(t){a[n]=t,i(t)})},o.send()}},c=function(e){e.bufferSource=t.createBufferSource(),e.bufferSource.buffer=a[e.src],e.bufferSource.connect(e.gainNode),e.bufferSource.loop=e._loop,e.bufferSource.onended=e._onended},h=t.createGain();h.gain.value=1,h.connect(t.destination),e=function(e){this.id=r(this),this._listenerId=0,this._listeners={},this._autoplay=!1,this._buffered=[],this._currentSrc="",this._currentTime=0,this._defaultPlaybackRate=1,this._duration=0/0,this._loop=!1,this._muted=!1,this._paused=!0,this._playbackRate=1,this._played=[],this._preload="auto",this._seekable=[],this._seeking=!1,this._src="",this._volume=1,this._onended=null,this._onload=null,this.gainNode=t.createGain(),this.gainNode.gain.value=this._volume,this.gainNode.connect(h),void 0!==e&&(this.src=e)},e.prototype.load=function(){this._src&&u(this,this._src)},e.prototype.play=function(){this._paused=!1,c(this),this.bufferSource.start?this.bufferSource.start(0):this.bufferSource.noteOn(0)},e.prototype.pause=function(){this._paused||(this._paused=!0,this.bufferSource.stop?this.bufferSource.stop(0):this.bufferSource.noteOff(0))},e.prototype.stop=function(){this._paused||(this.pause(),this.currentTime=0)},e.prototype.addEventListener=function(t,e){this._listeners[++this._listenerKey]={eventName:t,callback:e}},e.prototype.dispatchEvent=function(t,e){for(var n in this._listeners){var i=this._listeners[n];i.eventName==t&&i.callback&&i.callback.apply(i.callback,e)}},e.prototype.removeEventListener=function(t,e){var n=null;for(var i in this._listeners){var o=this._listeners[i];if(o.eventName===t&&o.callback===e){n=i;break}}null!==n&&delete this._listeners[n]},Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._autoplay},set:function(t){this._autoplay=t}}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._buffered}}),Object.defineProperty(e.prototype,"currentSrc",{get:function(){return this._currentSrc}}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},set:function(t){this._currentTime=t}}),Object.defineProperty(e.prototype,"defaultPlaybackRate",{get:function(){return Number(this._defaultPlaybackRate)},set:function(t){this._defaultPlaybackRate=t}}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration}}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop!==t&&(this._loop=t,this.bufferSource&&(this._paused?(c(this),this.bufferSource.loop=t):(this.pause(),c(this),this.bufferSource.loop=t,this.play())))}}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.gainNode.gain.value=t?0:this._volume}}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused}}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t}}),Object.defineProperty(e.prototype,"played",{get:function(){return this._played}}),Object.defineProperty(e.prototype,"preload",{get:function(){return this._preload},set:function(t){this._preload=t}}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this._seekable}}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this._seeking}}),Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(t){this._src=t,u(this,t)}}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){e.preventErrors||s(t,0,1)!==t,0>t&&(t=0),this._volume=t,this._muted||(this.gainNode.gain.value=t,this.dispatchEvent("volumechange"))}}),Object.defineProperty(e.prototype,"onended",{get:function(){return this._onended},set:function(t){this._onended=t}}),Object.defineProperty(e.prototype,"onload",{get:function(){return this._onload},set:function(t){this._onload=t}})}else e=function(t){this.id=r(this),this._audioNode=new Audio,void 0!==t&&(this.src=t)},e.prototype.load=function(){this._audioNode.load()},e.prototype.play=function(t){void 0!==t&&(this._audioNode.currentTime=t),this._audioNode.play()},e.prototype.pause=function(){this._audioNode.pause()},e.prototype.stop=function(){this._audioNode.pause(),this._audioNode.currentTime=0},e.prototype.addEventListener=function(t,e,n){this._audioNode.addEventListener(t,e,n)},e.prototype.removeEventListener=function(t,e,n){this._audioNode.removeEventListener(t,e,n)},Object.defineProperty(e.prototype,"autoplay",{get:function(){return this._audioNode.autoplay},set:function(t){this._audioNode.autoplay=t}}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._audioNode.buffered}}),Object.defineProperty(e.prototype,"currentSrc",{get:function(){return this._audioNode.src}}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._audioNode.currentTime},set:function(t){this._audioNode.currentTime=t}}),Object.defineProperty(e.prototype,"defaultPlaybackRate",{get:function(){return this._audioNode.defaultPlaybackRate},set:function(t){this._audioNode.defaultPlaybackRate=t}}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._audioNode.duration}}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._audioNode.loop},set:function(t){this._audioNode.currentTime>=this._audioNode.duration&&(this._audioNode.currentTime=0),this._audioNode.loop=t}}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._audioNode.muted},set:function(t){this._audioNode.muted=t}}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._audioNode.paused}}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._audioNode.playbackRate},set:function(t){this._audioNode.playbackRate=t}}),Object.defineProperty(e.prototype,"played",{get:function(){return this._audioNode.played}}),Object.defineProperty(e.prototype,"preload",{get:function(){return this._audioNode.preload},set:function(t){this._audioNode.preload=t}}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this._audioNode.seekable}}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this._audioNode.seeking}}),Object.defineProperty(e.prototype,"src",{get:function(){return this._audioNode.src},set:function(t){var e=this,n=function(){e.onload&&e.onload(),e._audioNode.removeEventListener("canplaythrough",n,!1)};this._audioNode.src=t,this._audioNode.preload="auto",this._audioNode.addEventListener("canplaythrough",n,!1),this._audioNode.addEventListener("error",function(){console.log("audio load error",e._audioNode.error)},!1),this._audioNode.load()}}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._audioNode.volume},set:function(t){if(e.preventErrors)var t=s(t,0,1);this._audioNode.volume=t}}),Object.defineProperty(e.prototype,"onended",{get:function(){return this._audioNode.onended
},set:function(t){this._audioNode.onended=t}}),Object.defineProperty(e.prototype,"onload",{get:function(){return this._audioNode.onload},set:function(t){this._audioNode.onload=t}});e.preventErrors=!0,Object.defineProperty(e,"hasWebAudio",{get:function(){return n}}),Object.defineProperty(e,"audioContext",{get:function(){return t}}),Object.defineProperty(e,"gainNode",{get:function(){return h}}),Object.defineProperty(e,"version",{get:function(){return"0.3.0"}});var l;e.canPlayType=function(t){void 0===l&&(l=new Audio);var t=(null===t.match("/")?"audio/":"")+t;return l.canPlayType(t)},e.prototype.canPlayType=function(t){return e.canPlayType(t)};for(var d=["abort","canplay","canplaythrough","durationchange","emptied","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange"],f=0,p=d.length;p>f;++f)!function(t){var n="_on"+t;e.prototype[n]=null,Object.defineProperty(e.prototype,"on"+t,{get:function(){return this[n]},set:function(e){this[n]&&this.removeEventListener(t,this[n],!1),"function"==typeof e?(this[n]=e,this.addEventListener(t,e,!1)):this[n]=null}})}(d[f]);return e}),bento.define("bento",["bento/utils","bento/lib/domready","bento/managers/asset","bento/managers/input","bento/managers/object","bento/managers/audio","bento/managers/screen","bento/managers/savestate","bento/math/vector2","bento/math/rectangle","bento/renderer"],function(t,e,n,i,o,r,s,a,u,c,h){"use strict";var l,d,f,p=((new Date).getTime(),!0),m=0,g=!1,y={x:1,y:1},b={},v=new c(0,0,640,480),w=function(e,n){var i,o=window.devicePixelRatio||1,r=window.innerWidth*o,s=window.innerHeight*o;l=document.getElementById(e.canvasId),l||(i=document.getElementById("wrapper"),i||(i=document.body),l=document.createElement(t.isCocoonJS()?"screencanvas":"canvas"),l.id=e.canvasId,i.appendChild(l)),l.width=v.width,l.height=v.height,m=v.height/v.width,e.renderer=e.renderer||"auto","auto"===e.renderer&&(e.pixelSize=Math.round(r>s?Math.max(s/l.height,1):Math.max(r/l.width,1)),e.pixelSize=Math.min(e.pixelSize,3),e.renderer="webgl",t.isCocoonJS()&&(e.renderer="canvas2d")),h(e.renderer,l,e,function(t){d=t,b={canvas:l,renderer:t,canvasScale:y,viewport:v,entity:null},n()})},x=function(){var t,e,n=window.innerWidth,i=window.innerHeight;g||(f=i/n,m>f?(t=i/m,e=i):(t=n,e=n*m),p?(l.style.width=t+"px",l.style.height=e+"px"):(l.width=t,l.height=e),y.x=t/v.width,y.y=e/v.height)},C={setup:function(a,u){e(function(){var e=function(){C.objects.run(),u&&u()};if(a.canvasDimension){if(!a.canvasDimension.isRectangle)throw"settings.canvasDimension must be a rectangle";v=a.canvasDimension||v}a.sortMode=a.sortMode||0,w(a,function(){g=a.manualResize,window.addEventListener("resize",x,!1),window.addEventListener("orientationchange",x,!1),x(),C.input=i(b),C.objects=o(b,a),C.assets=n(),C.audio=r(C),C.screens=s(),t.extend(C,C.objects),a.assetGroups?C.assets.loadAssetGroups(a.assetGroups,e):e()})})},getViewport:function(){return v},getCanvas:function(){return l},getRenderer:function(){return d},getGameData:function(){return{canvas:l,renderer:d,canvasScale:y,viewport:v,entity:null}},assets:null,objects:null,input:null,audio:null,screens:null,saveState:a,utils:t};return C}),bento.define("bento/color",["bento/utils"],function(t){return function(e,n,i,o){return e/=255,e=n/255,e=i/255,t.isDefined(o)||(o=1),[e,n,i,o]}}),bento.define("bento/entity",["bento","bento/utils","bento/math/vector2","bento/math/rectangle","bento/math/matrix"],function(t,e,n,i,o){"use strict";var r=function(t){var e;for(e=t.components.length-1;e>=0;--e)t.components[e]||t.components.splice(e,1)},s=0,a=function(o){var r;if(this.id=s++,this.z=0,this.timer=0,this.global=!1,this["float"]=!1,this.updateWhenPaused=!1,this.name="",this.isAdded=!1,this.useHshg=!1,this.position=new n(0,0),this.origin=new n(0,0),this.family=[],this.components=[],this.dimension=new i(0,0,0,0),this.boundingBox=null,this.scale=new n(1,1),this.rotation=0,this.visible=!0,this.parent=null,this.settings=o,o){if(o.components)for(e.isArray(o.components)||(o.components=[o.components]),r=0;r<o.components.length;++r)this.attach(o.components[r]);if(o.position&&(this.position=o.position),o.origin&&(this.origin=o.origin),o.originRelative&&this.setOriginRelative(o.originRelative),o.name&&(this.name=o.name),o.family)for(e.isArray(o.family)||(o.family=[o.family]),r=0;r<o.family.length;++r)this.family.push(o.family[r]);o.init&&o.init.apply(this),this.z=o.z||0,this.updateWhenPaused=o.updateWhenPaused||!1,this.global=o.global||!1,this["float"]=o["float"]||!1,this.useHshg=o.useHshg||!1,this.staticHshg=o.staticHshg||!1,this.onCollide=o.onCollide,o.addNow&&t.objects.add(this)}};return a.prototype.start=function(t){var e,n,i;for(t=t||{},e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.start&&(t.entity=this,i.start(t))},a.prototype.destroy=function(t){var e,n,i;for(t=t||{},e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.destroy&&(t.entity=this,i.destroy(t))},a.prototype.update=function(t){var e,n,i;for(t=t||{},e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.update&&(t.entity=this,i.update(t));++this.timer,r(this)},a.prototype.draw=function(t){var e,n,i;if(this.visible){for(t=t||{},e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.draw&&(t.entity=this,i.draw(t));for(e=this.components.length-1;e>=0;e--)i=this.components[e],i&&i.postDraw&&(t.entity=this,i.postDraw(t))}},a.prototype.extend=function(t){return e.extend(this,t)},a.prototype.getBoundingBox=function(){var t,e,o,r,s,a;return this.boundingBox?(a=this.boundingBox.clone(),t=this.scale?this.scale:new n(1,1),a.x*=Math.abs(t.x),a.y*=Math.abs(t.y),a.width*=Math.abs(t.x),a.height*=Math.abs(t.y),a.x+=this.position.x,a.y+=this.position.y,a):(t=this.scale?this.scale:new n(1,1),e=this.position.x-this.origin.x*t.x,r=this.position.y-this.origin.y*t.y,o=this.position.x+(this.dimension.width-this.origin.x)*t.x,s=this.position.y+(this.dimension.height-this.origin.y)*t.y,t.x<0&&(o=[e,e=o][0]),t.y<0&&(s=[r,r=s][0]),new i(e,r,o-e,s-r))},a.prototype.setOriginRelative=function(t){this.origin.x=t.x*this.dimension.width,this.origin.y=t.y*this.dimension.height},a.prototype.attached=function(t){var e,n,i;for(t?(t.entity=this,t.parent=this.parent):t={entity:this,parent:this.parent},e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.onParentAttached&&(t.entity=this,i.onParentAttached(t))},a.prototype.collided=function(t){var e,n,i;if(!t)throw"Must pass a data object";for(t.entity=this,t.parent=this.parent,e=0,n=this.components.length;n>e;++e)i=this.components[e],i&&i.onParentCollided&&(t.entity=this,i.onParentCollided(t));this.onCollide&&this.onCollide(t.other)},a.prototype.attach=function(t){var e=this;if(this.components.push(t),t.parent=this,t.init&&t.init(),t.attached&&t.attached({entity:this}),this.isAdded)t.start&&t.start();else for(e.parent&&(e=e.parent);e;)e.isAdded&&t.start&&t.start(),e=e.parent;return this},a.prototype.remove=function(t){var e;if(t)return e=this.components.indexOf(t),e>=0&&(t.destroy&&t.destroy(),t.parent=null,this.components[e]=null),this},a.prototype.getComponent=function(t,e){var n,i,o;for(n=0,i=this.components.length;i>n;++n)if(o=this.components[n],o&&o.name===t)return e&&e.apply(o,[o]),o},a.prototype.moveComponentTo=function(t,e){var n;t&&(n=this.components.indexOf(t),n>=0&&(this.components.splice(n,1),this.components.splice(e,0,t)))},a.prototype.collidesWith=function(t,i,o){var r;return e.isDefined(i)||(i=new n(0,0)),r=this.getBoundingBox().offset(i).intersect(t.getBoundingBox()),r&&o&&o(t),r},a.prototype.collidesWithGroup=function(t,i,o){var r,s,a;if(e.isDefined(i)||(i=new n(0,0)),!e.isArray(t))return void console.log("Collision check must be with an Array of object");if(!t.length)return null;for(a=this.getBoundingBox().offset(i),r=0;r<t.length;++r)if(s=t[r],(!s.id||s.id!==this.id)&&s.getBoundingBox&&a.intersect(s.getBoundingBox()))return o&&o(s),s;return null},a.prototype.getAABB=function(){var t;return this.staticHshg?(this.box||(this.box=this.getBoundingBox()),t=this.box):t=this.getBoundingBox(),{min:[t.x,t.y],max:[t.x+t.width,t.y+t.height]}},a.prototype.getWorldPosition=function(){var e,i,r,s,a,u,c=new o(3,3),h=new o(3,3),l=new o(3,3),d=[];if(!this.parent)return this["float"]?this.position:this.position.add(t.getViewport().getCorner());for(e=this["float"]?this.position.add(t.getViewport().getCorner()).toMatrix():this.position.toMatrix(),a=this;a.parent;)a=a.parent,d.unshift(a);for(u=0;u<d.length;++u)a=d[u],a.scale&&(h.set(0,0,a.scale.x),h.set(1,1,a.scale.y),e.multiplyWith(h)),a.rotation&&(i=Math.sin(a.rotation),r=Math.cos(a.rotation),l.set(0,0,r),l.set(1,0,-i),l.set(0,1,i),l.set(1,1,r),e.multiplyWith(l)),a.position&&(s=a.position,c.set(2,0,s.x),c.set(2,1,s.y),e.multiplyWith(c));return new n(e.get(0,0),e.get(0,1))},a.prototype.toString=function(){return"[object Entity]"},a}),bento.define("bento/eventsystem",["bento/utils"],function(t){var e={},n=[],i=function(){var i,o,r,s,a,u;for(o=0;o<n.length;o+=1)if(s=n[o].eventName,a=n[o].callback,u=n[o].context,!t.isUndefined(e[s]))for(r=e[s],i=r.length-1;i>=0;i-=1)if(r[i].callback===a){if(!u){e[s].splice(i,1);break}if(r[i].context===u){e[s].splice(i,1);break}}n=[]},o=function(n,i,o){t.isUndefined(e[n])&&(e[n]=[]),e[n].push({callback:i,context:o})},r=function(t,e,i){n.push({eventName:t,callback:e,context:i})};return{fire:function(n,o){var r,s,a,u;if(i(),t.isString(n)||(n=n.toString()),!t.isUndefined(e[n]))for(a=e[n],r=0,s=a.length;s>r;++r)u=a[r],u?u.context?u.callback.apply(u.context,[o]):u.callback(o):console.log("Warning: listener is not a function")},addEventListener:o,removeEventListener:r,on:o,off:r}}),bento.define("bento/packedimage",["bento/math/rectangle"],function(t){return function(e,n){var i=n?new t(n.x,n.y,n.w,n.h):new t(0,0,e.width,e.height);return i.image=e,i}}),bento.define("bento/renderer",["bento/utils"],function(t){return function(e,n,i,o){var r={save:function(){},restore:function(){},translate:function(){},scale:function(){},rotate:function(){},fillRect:function(){},fillCircle:function(){},strokeRect:function(){},drawImage:function(){},begin:function(){},flush:function(){},setColor:function(){},getOpacity:function(){},setOpacity:function(){},createSurface:function(){},setContext:function(){},restoreContext:function(){}};bento.require(["bento/renderers/"+e],function(e){t.extend(r,e(n,i),!0),o(r)})}}),bento.define("bento/utils",[],function(){"use strict";var t,e=function(t){return"string"==typeof t||t instanceof String},n=Array.prototype.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=function(t){return"[object Object]"===Object.prototype.toString.call(t)},o=function(t){return"[object Function]"===Object.prototype.toString.call(t)},r=function(t){return"[object Number]"===Object.prototype.toString.call(t)},s=function(t){return t===!0||t===!1||"[object Boolean]"===Object.prototype.toString.call(t)},a=function(t){return parseFloat(t)===parseInt(t,10)&&!isNaN(t)},u=function(t){return void 0===t},c=function(t){return void 0!==t},h=function(t){var e=t;return"object"!=typeof t||null===t?!1:function(){for(;;)if(null===Object.getPrototypeOf(e=Object.getPrototypeOf(e)))break;return Object.getPrototypeOf(t)===e}()},l=function(t,e){var n,i;for(n=0,i=t.length;i>n;n+=1)if(t[n]===e){t.splice(n,1);break}},d=function(t,e,n){var i,o;for(i in e)e.hasOwnProperty(i)&&(t.hasOwnProperty(i)&&!n&&(t.base=t.base||{},o={},o[i]=t[i],d(t.base,o)),t[i]=h(e[i])?d({},e[i]):e[i]);return t},f=function(t){return Object.keys(t).length},p=function(){var t=function(t,n){return e(t.slice(),n)},e=function(t,e){"function"!=typeof e&&(e=function(t,e){return String(t).localeCompare(e)});var i=t.length;if(1>=i)return t;for(var o=new Array(i),r=1;i>r;r*=2){n(t,e,r,o);var s=t;t=o,o=s}return t},n=function(t,e,n,i){var o,r,s,a,u,c=t.length,h=0,l=2*n;for(o=0;c>o;o+=l)for(r=o+n,s=r+n,r>c&&(r=c),s>c&&(s=c),a=o,u=r;;)if(r>a&&s>u)i[h++]=e(t[a],t[u])<=0?t[a++]:t[u++];else if(r>a)i[h++]=t[a++];else{if(!(s>u))break;i[h++]=t[u++]}};return t.inplace=function(t,i){var o=e(t,i);return o!==t&&n(o,null,t.length,t),t},t}(),m=function(){var t,e={3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdivide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]};for(t=65;90>=t;t+=1)e[t]=String.fromCharCode(t+32);return e}();return t={isString:e,isArray:n,isObject:i,isFunction:o,isNumber:r,isBoolean:s,isInt:a,isUndefined:u,isDefined:c,removeObject:l,extend:d,getKeyLength:f,stableSort:p,keyboardMapping:m,getRandom:function(t){return Math.floor(Math.random()*t)},toRadian:function(t){return t*Math.PI/180},toDegree:function(t){return t/Math.PI*180},sign:function(t){return t>0?1:0>t?-1:0},approach:function(t,e,n){return e>t?Math.min(t+n,e):Math.max(t-n,e)},repeat:function(t,e){var n;for(n=0;t>n;++n)e()},isApple:function(){var t=navigator.userAgent.match(/iPhone|iPad|iPod/i);return/iPhone/i.test(t)||/iPad/i.test(t)||/iPod/i.test(t)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isCocoonJS:function(){return navigator.isCocoonJS},SortMode:{ALWAYS:0,NEVER:1,SORT_ON_ADD:2}}}),bento.define("bento/lib/domready",[],function(){"use strict";function t(t){var e;for(e=0;e<t.length;e+=1)t[e](c)}function e(){var e=h;u&&e.length&&(h=[],t(e))}function n(){u||(u=!0,s&&clearInterval(s),e())}function i(t){return u?t(c):h.push(t),i}var o,r,s,a="undefined"!=typeof window&&window.document,u=!a,c=a?document:null,h=[];if(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),r=document.createElement("div");try{o=null===window.frameElement}catch(l){}r.doScroll&&o&&window.external&&(s=setInterval(function(){try{r.doScroll(),n()}catch(t){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(t,e,n,o){o.isBuild?n(null):i(n)},i}),bento.define("hshg",[],function(){function t(){var t,e,n,i,o,r;for(t=0;t<this._globalObjects.length;t++)e=this._globalObjects[t],i=e.HSHG,n=i.grid,e.staticHshg||(o=e.getAABB(),r=n.toHash(o.min[0],o.min[1]),r!==i.hash&&(n.removeObject(e),n.addObject(e,r)))}function e(){}function n(t,e){var n,i;return t.staticHshg&&e.staticHshg?!1:(n=t.getAABB(),i=e.getAABB(),n.min[0]>i.max[0]||n.min[1]>i.max[1]||n.max[0]<i.min[0]||n.max[1]<i.min[1]?!1:!0)}function i(t,e){return Math.max(Math.abs(e[0]-t[0]),Math.abs(e[1]-t[1]))}function o(){this.MAX_OBJECT_CELL_DENSITY=1/8,this.INITIAL_GRID_LENGTH=256,this.HIERARCHY_FACTOR=2,this.HIERARCHY_FACTOR_SQRT=Math.SQRT2,this.UPDATE_METHOD=t,this._grids=[],this._globalObjects=[]}function r(t,e,n){this.cellSize=t,this.inverseCellSize=1/t,this.rowColumnCount=~~Math.sqrt(e),this.xyHashMask=this.rowColumnCount-1,this.occupiedCells=[],this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.allObjects=[],this.sharedInnerOffsets=[],this._parentHierarchy=n||null}function s(){this.objectContainer=[],this.neighborOffsetArray,this.occupiedCellsIndex=null,this.allCellsIndex=null}return o.prototype.addObject=function(t){var e,n,o,s,a,u=t.getAABB(),c=i(u.min,u.max);if(t.HSHG={globalObjectsIndex:this._globalObjects.length},this._globalObjects.push(t),0==this._grids.length)o=c*this.HIERARCHY_FACTOR_SQRT,a=new r(o,this.INITIAL_GRID_LENGTH,this),a.initCells(),a.addObject(t),this._grids.push(a);else{for(e=0,n=0;n<this._grids.length;n++)if(s=this._grids[n],e=s.cellSize,e>c){if(e/=this.HIERARCHY_FACTOR,e>c){for(;e>c;)e/=this.HIERARCHY_FACTOR;a=new r(e*this.HIERARCHY_FACTOR,this.INITIAL_GRID_LENGTH,this),a.initCells(),a.addObject(t),this._grids.splice(n,0,a)}else s.addObject(t);return}for(;c>=e;)e*=this.HIERARCHY_FACTOR;a=new r(e,this.INITIAL_GRID_LENGTH,this),a.initCells(),a.addObject(t),this._grids.push(a)}},o.prototype.removeObject=function(t){var e,n,i=t.HSHG;void 0!==i&&(e=i.globalObjectsIndex,e===this._globalObjects.length-1?this._globalObjects.pop():(n=this._globalObjects.pop(),n.HSHG.globalObjectsIndex=e,this._globalObjects[e]=n),i.grid.removeObject(t),delete t.HSHG)},o.prototype.update=function(){this.UPDATE_METHOD.call(this)},o.prototype.queryForCollisionPairs=function(t){var e,i,o,r,s,a,u,c,h,l,d,f,p,m,g=[];for(broadOverlapTest=t||n,e=0;e<this._grids.length;e++){for(a=this._grids[e],i=0;i<a.occupiedCells.length;i++){for(u=a.occupiedCells[i],o=0;o<u.objectContainer.length;o++)for(c=u.objectContainer[o],r=o+1;r<u.objectContainer.length;r++)h=u.objectContainer[r],broadOverlapTest(c,h)===!0&&g.push([c,h]);for(s=0;4>s;s++)for(l=u.neighborOffsetArray[s],d=a.allCells[u.allCellsIndex+l],o=0;o<u.objectContainer.length;o++)for(c=u.objectContainer[o],r=0;r<d.objectContainer.length;r++)h=d.objectContainer[r],broadOverlapTest(c,h)===!0&&g.push([c,h])}for(i=0;i<a.allObjects.length;i++)for(c=a.allObjects[i],p=c.getAABB(),o=e+1;o<this._grids.length;o++)for(f=this._grids[o],m=f.toHash(p.min[0],p.min[1]),u=f.allCells[m],s=0;s<u.neighborOffsetArray.length;s++)for(l=u.neighborOffsetArray[s],d=f.allCells[u.allCellsIndex+l],r=0;r<d.objectContainer.length;r++)h=d.objectContainer[r],broadOverlapTest(c,h)===!0&&g.push([c,h])}for(e=0;e<g.length;++e)g[e][0].collided&&g[e][0].collided({other:g[e][1]}),g[e][1].collided&&g[e][1].collided({other:g[e][0]});return g},o.update_RECOMPUTE=t,o.update_REMOVEALL=e,r.prototype.initCells=function(){var t,e,n,i,o,r,a,u,c,h,l,d,f=this.allCells.length,p=this.rowColumnCount,m=[p-1,p,p+1,-1,0,1,-1+-p,-p,-p+1],g=[];for(this.sharedInnerOffsets=m,t=0;f>t;t++)d=new s,n=~~(t/this.rowColumnCount),e=~~(t-n*this.rowColumnCount),i=!1,o=!1,r=!1,a=!1,(e+1)%this.rowColumnCount==0?i=!0:e%this.rowColumnCount==0&&(o=!0),(n+1)%this.rowColumnCount==0?r=!0:n%this.rowColumnCount==0&&(a=!0),i||o||r||a?(c=i===!0?-p+1:1,u=o===!0?p-1:-1,h=r===!0?-f+p:p,l=a===!0?f-p:-p,g=[u+h,h,c+h,u,0,c,u+l,l,c+l],d.neighborOffsetArray=g):d.neighborOffsetArray=this.sharedInnerOffsets,d.allCellsIndex=t,this.allCells[t]=d},r.prototype.toHash=function(t,e){var n,i,o;return 0>t?(n=-t*this.inverseCellSize,i=this.rowColumnCount-1-(~~n&this.xyHashMask)):(n=t*this.inverseCellSize,i=~~n&this.xyHashMask),0>e?(n=-e*this.inverseCellSize,o=this.rowColumnCount-1-(~~n&this.xyHashMask)):(n=e*this.inverseCellSize,o=~~n&this.xyHashMask),i+o*this.rowColumnCount},r.prototype.addObject=function(t,e){var n,i,o;void 0!==e?i=e:(n=t.getAABB(),i=this.toHash(n.min[0],n.min[1])),o=this.allCells[i],0===o.objectContainer.length&&(o.occupiedCellsIndex=this.occupiedCells.length,this.occupiedCells.push(o)),t.HSHG.objectContainerIndex=o.objectContainer.length,t.HSHG.hash=i,t.HSHG.grid=this,t.HSHG.allGridObjectsIndex=this.allObjects.length,o.objectContainer.push(t),this.allObjects.push(t),this.allObjects.length/this.allCells.length>this._parentHierarchy.MAX_OBJECT_CELL_DENSITY&&this.expandGrid()},r.prototype.removeObject=function(t){var e,n,i,o,r,s,a=t.HSHG;e=a.hash,n=a.objectContainerIndex,i=a.allGridObjectsIndex,o=this.allCells[e],1===o.objectContainer.length?(o.objectContainer.length=0,o.occupiedCellsIndex===this.occupiedCells.length-1?this.occupiedCells.pop():(r=this.occupiedCells.pop(),r.occupiedCellsIndex=o.occupiedCellsIndex,this.occupiedCells[o.occupiedCellsIndex]=r),o.occupiedCellsIndex=null):n===o.objectContainer.length-1?o.objectContainer.pop():(s=o.objectContainer.pop(),s.HSHG.objectContainerIndex=n,o.objectContainer[n]=s),i===this.allObjects.length-1?this.allObjects.pop():(s=this.allObjects.pop(),s.HSHG.allGridObjectsIndex=i,this.allObjects[i]=s)},r.prototype.expandGrid=function(){{var t,e=this.allCells.length,n=(this.rowColumnCount,this.xyHashMask,4*e),i=~~Math.sqrt(n),o=i-1,r=this.allObjects.slice(0);Array.prototype.push}for(t=0;t<r.length;t++)this.removeObject(r[t]);for(this.rowColumnCount=i,this.allCells=Array(this.rowColumnCount*this.rowColumnCount),this.xyHashMask=o,this.initCells(),t=0;t<r.length;t++)this.addObject(r[t])},o._private={Grid:r,Cell:s,testAABBOverlap:n,getLongestAABBEdge:i},o}),bento.define("lzstring",[],function(){function t(t,e){if(!o[t]){o[t]={};for(var n=0;n<t.length;n++)o[t][t.charAt(n)]=n}return o[t][e]}var e=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},r={compressToBase64:function(t){if(null==t)return"";var e=r._compress(t,6,function(t){return n.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:r._decompress(e.length,32,function(i){return t(n,e.charAt(i))})},compressToUTF16:function(t){return null==t?"":r._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:r._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=r.compress(t),n=new Uint8Array(2*e.length),i=0,o=e.length;o>i;i++){var s=e.charCodeAt(i);n[2*i]=s>>>8,n[2*i+1]=s%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return r.decompress(t);for(var n=new Array(t.length/2),i=0,o=n.length;o>i;i++)n[i]=256*t[2*i]+t[2*i+1];var s=[];return n.forEach(function(t){s.push(e(t))}),r.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":r._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),r._decompress(e.length,32,function(n){return t(i,e.charAt(n))}))},compress:function(t){return r._compress(t,16,function(t){return e(t)})},_compress:function(t,e,n){if(null==t)return"";var i,o,r,s={},a={},u="",c="",h="",l=2,d=3,f=2,p=[],m=0,g=0;for(r=0;r<t.length;r+=1)if(u=t.charAt(r),Object.prototype.hasOwnProperty.call(s,u)||(s[u]=d++,a[u]=!0),c=h+u,Object.prototype.hasOwnProperty.call(s,c))h=c;else{if(Object.prototype.hasOwnProperty.call(a,h)){if(h.charCodeAt(0)<256){for(i=0;f>i;i++)m<<=1,g==e-1?(g=0,p.push(n(m)),m=0):g++;for(o=h.charCodeAt(0),i=0;8>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1}else{for(o=1,i=0;f>i;i++)m=m<<1|o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o=0;for(o=h.charCodeAt(0),i=0;16>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1}l--,0==l&&(l=Math.pow(2,f),f++),delete a[h]}else for(o=s[h],i=0;f>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1;l--,0==l&&(l=Math.pow(2,f),f++),s[c]=d++,h=String(u)}if(""!==h){if(Object.prototype.hasOwnProperty.call(a,h)){if(h.charCodeAt(0)<256){for(i=0;f>i;i++)m<<=1,g==e-1?(g=0,p.push(n(m)),m=0):g++;for(o=h.charCodeAt(0),i=0;8>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1}else{for(o=1,i=0;f>i;i++)m=m<<1|o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o=0;for(o=h.charCodeAt(0),i=0;16>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1}l--,0==l&&(l=Math.pow(2,f),f++),delete a[h]}else for(o=s[h],i=0;f>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1;l--,0==l&&(l=Math.pow(2,f),f++)}for(o=2,i=0;f>i;i++)m=m<<1|1&o,g==e-1?(g=0,p.push(n(m)),m=0):g++,o>>=1;for(;;){if(m<<=1,g==e-1){p.push(n(m));break}g++}return p.join("")},decompress:function(t){return null==t?"":""==t?null:r._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(t,n,i){var o,r,s,a,u,c,h,l,d=[],f=4,p=4,m=3,g="",y=[],b={val:i(0),position:n,index:1};for(r=0;3>r;r+=1)d[r]=r;for(a=0,c=Math.pow(2,2),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;switch(o=a){case 0:for(a=0,c=Math.pow(2,8),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;l=e(a);break;case 1:for(a=0,c=Math.pow(2,16),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;l=e(a);break;case 2:return""}for(d[3]=l,s=l,y.push(l);;){if(b.index>t)return"";for(a=0,c=Math.pow(2,m),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;switch(l=a){case 0:for(a=0,c=Math.pow(2,8),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;d[p++]=e(a),l=p-1,f--;break;case 1:for(a=0,c=Math.pow(2,16),h=1;h!=c;)u=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=i(b.index++)),a|=(u>0?1:0)*h,h<<=1;d[p++]=e(a),l=p-1,f--;break;case 2:return y.join("")}if(0==f&&(f=Math.pow(2,m),m++),d[l])g=d[l];else{if(l!==p)return null;g=s+s.charAt(0)}y.push(g),d[p++]=s+g.charAt(0),f--,s=g,0==f&&(f=Math.pow(2,m),m++)}}};return r}),bento.define("bento/lib/requestanimationframe",[],function(){"use strict";for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),i=Math.max(0,16-(n-t)),o=window.setTimeout(function(){e(n+i)},i);return t=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.requestAnimationFrame}),bento.define("bento/managers/asset",["bento/packedimage","bento/utils","audia"],function(t,e,n){"use strict";return function(){var i={},o="",r={audio:{},json:{},images:{},binary:{}},s={},a=[],u=function(t,i,r){var s,a,u,c=!0;if(e.isArray(i))for(a=0;a<i.length;a+=1)i[a]=o+"audio/"+i[a];else i=[o+"audio/"+i];for(a=0;a<i.length;++a)if(s=new n,u=s.canPlayType("audio/"+i[a].slice(-3))){s.onload=function(){r(null,t,s)},s.src=i[a],c=!1;break}c&&r("This audio type is not supported:",t,i)},c=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("application/json"),i.open("GET",e,!0),i.onerror=function(){n("Error "+e)},i.ontimeout=function(){n("Timeout"+e)},i.onreadystatechange=function(){4===i.readyState&&(304===i.status||200===i.status||0===i.status&&i.responseText?n(null,t,JSON.parse(i.responseText)):n("Error: State "+i.readyState+" "+e))},i.send(null)},h=function(t,e,n){var i=new Image;i.src=e,i.addEventListener("load",function(){n(null,t,i)},!1)},l=function(t,n,o){var r,s=e.getKeyLength(t),a=0,u=function(t,r,u){return t?void console.log(t):(i[r]=u,a+=1,e.isDefined(o)&&o(a,s),void(s===a&&e.isDefined(n)&&n(null)))};for(r in t)t.hasOwnProperty(r)&&c(r,t[r],u)},d=function(t,n,s){var l,d=i[t],f=0,p=0,m=[],g=function(){f===p&&e.isDefined(n)&&(v(),n(null))},y=function(t,n,i){return t?void console.log(t):(r.images[n]=i,f+=1,e.isDefined(s)&&s(f,p),void g())},b=function(t,n,i){return t?void console.log(t):(r.json[n]=i,a.push(n),f+=1,e.isDefined(s)&&s(f,p),void g())},w=function(t,n,i){return t?void console.log(t):(r.json[n]=i,f+=1,e.isDefined(s)&&s(f,p),void g())},x=function(t,n,i){t?console.log(t):r.audio[n]=i,f+=1,e.isDefined(s)&&s(f,p),g()},C=function(t,e,n,i){m.push({fn:t,asset:e,path:n,callback:i})},S=function(){var t,e=0;for(e=0;e<m.length;++e)t=m[e],t.fn(t.asset,t.path,t.callback)};if(!e.isDefined(d))return void n("Could not find asset group "+t);if(e.isDefined(d.path)&&(o=d.path),e.isDefined(d.images)){p+=e.getKeyLength(d.images);for(l in d.images)d.images.hasOwnProperty(l)&&C(h,l,o+"images/"+d.images[l],y)}if(e.isDefined(d.texturePacker)){p+=e.getKeyLength(d.texturePacker);for(l in d.texturePacker)d.texturePacker.hasOwnProperty(l)&&C(c,l,o+"json/"+d.texturePacker[l],b)}if(e.isDefined(d.audio)){p+=e.getKeyLength(d.audio);for(l in d.audio)d.audio.hasOwnProperty(l)&&C(u,l,d.audio[l],x)}if(e.isDefined(d.json)){p+=e.getKeyLength(d.json);for(l in d.json)d.json.hasOwnProperty(l)&&C(c,l,o+"json/"+d.json[l],w)}S()},f=function(){},p=function(e){var n,i=s[e];if(!i){if(n=m(e),!n)throw"Can not find "+e;i=t(n),s[e]=i}return i},m=function(t){var n=r.images[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},g=function(t){var n=r.json[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},y=function(t){var n=r.audio[t];if(!e.isDefined(n))throw"Asset "+t+" could not be found";return n},b=function(){return r},v=function(){for(var e,n,i,o,r;a.length;)for(n=a.pop(),o=m(n),r=g(n),i=0;i<r.frames.length;++i)name=r.frames[i].filename,name=name.substring(0,name.length-4),e=r.frames[i].frame,s[name]=t(o,e)},w=function(){return i};return{loadAssetGroups:l,load:d,unload:f,getImage:p,getImageElement:m,getJson:g,getAudio:y,getAssets:b,getAssetGroups:w}}}),define("bento/managers/audio",["bento/utils"],function(t){return function(e){var n,i,o=!1,r=!1,s=!1,a=!1,u=!1,c="",h=0,l=e.assets,d=(e.getCanvas(),function(t){t?(n=o,i=r,f.muteMusic(!0),f.muteSound(!0)):(o=n,r=i,f.playMusic(c,u))}),f={setVolume:function(t,e){l.getAudio(e).volume=t},getVolume:function(t){return l.getAudio(t).volume},playSound:function(e,n,i){var r=l.getAudio(e);o||s||(t.isDefined(n)&&(r.loop=n),t.isDefined(i)&&(r.onended=i),r.play())},stopSound:function(t){l.getAudio(t).stop()},playMusic:function(e,n,i,o){var s;c=e,u=t.isDefined(n)?n:!0,r||""===c||(s=l.getAudio(e),i&&(s.onended=i),s.loop=u,s.play(o||0),a=!0)},stopMusic:function(t){l.getAudio(t).stop(),a=!1},muteSound:function(t){o=t,o&&this.stopAllSound()},muteMusic:function(e,n){var i=c;r=e,t.isDefined(n)||(n=!1),r?(f.stopAllMusic(),c=i):n&&""!==c&&f.playMusic(c,u)},stopAllSound:function(){var t,e=l.getAssets().audio;for(t in e)e.hasOwnProperty(t)&&"sfx"===t.substring(0,3)&&e[t].stop()},stopAllMusic:function(){var t,e=l.getAssets().audio;for(t in e)e.hasOwnProperty(t)&&"bgm"===t.substring(0,3)&&e[t].stop(t===c?h:void 0);c="",a=!1},preventSounds:function(t){s=t},isPlayingMusic:function(){return a}};return"hidden"in document?document.addEventListener("visibilitychange",function(){d(document.hidden)},!1):"mozHidden"in document?document.addEventListener("mozvisibilitychange",function(){d(document.mozHidden)},!1):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",function(){d(document.webkitHidden)},!1):"msHidden"in document?document.addEventListener("msvisibilitychange",function(){d(document.msHidden)},!1):"onpagehide"in window?(window.addEventListener("pagehide",function(){d(!0)},!1),window.addEventListener("pageshow",function(){d(!1)},!1)):"onblur"in document?(window.addEventListener("blur",function(){d(!0)},!1),window.addEventListener("focus",function(){d(!1)},!1),visHandled=!0):"onfocusout"in document&&(window.addEventListener("focusout",function(){d(!0)},!1),window.addEventListener("focusin",function(){d(!1)},!1)),f}}),bento.define("bento/managers/input",["bento/utils","bento/math/vector2","bento/eventsystem"],function(t,e,n){"use strict";var i={};return function(o){var r,s,a,u=!1,c=[],h={},l=0,d=0,f=function(t){c.push({id:t.id,position:t.position,eventType:t.eventType,localPosition:t.localPosition,worldPosition:t.worldPosition}),n.fire("pointerDown",t)
},p=function(t){n.fire("pointerMove",t),P(t)},m=function(t){n.fire("pointerUp",t),O(t)},g=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)C(t,e,"start"),f(t)},y=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)C(t,e,"move"),p(t)},b=function(t){var e;for(t.preventDefault(),e=0;e<t.changedTouches.length;e+=1)C(t,e,"end"),m(t)},v=function(t){t.preventDefault(),S(t,"start"),f(t)},w=function(t){t.preventDefault(),S(t,"move"),p(t)},x=function(t){t.preventDefault(),S(t,"end"),m(t)},C=function(t,n,o){var r=t.changedTouches[n],u=(r.pageX-l)/s.x,c=(r.pageY-d)/s.y,h={};t.preventDefault(),t.id=0,t.eventType="touch",r.position=new e(u,c),r.worldPosition=r.position.clone(),r.worldPosition.x+=a.x,r.worldPosition.y+=a.y,r.localPosition=r.position.clone(),t.position=r.position.clone(),t.worldPosition=r.worldPosition.clone(),t.localPosition=r.localPosition.clone(),t.id=r.identifier+1,"start"===o&&(h.startPosition=r.position.clone(),h.startWorldPosition=r.worldPosition.clone(),h.startLocalPosition=r.localPosition.clone(),i[t.id]=h),"end"===o&&(h=i[t.id],h&&h.startPosition?(r.diffPosition=r.position.substract(h.startPosition),r.diffWorldPosition=r.worldPosition.substract(h.startWorldPosition),r.diffLocalPosition=r.localPosition.substract(h.startLocalPosition),t.diffPosition=r.diffPosition.clone(),t.diffWorldPosition=r.diffWorldPosition.clone(),t.diffLocalPosition=r.diffLocalPosition.clone(),delete i[t.id]):console.log("WARNING: touch startPosition was not defined"))},S=function(t,n){var o=(t.pageX-l)/s.x,r=(t.pageY-d)/s.y,u={},c=-1;t.id=0,t.eventType="mouse",t.position=new e(o,r),t.worldPosition=t.position.clone(),t.worldPosition.x+=a.x,t.worldPosition.y+=a.y,t.localPosition=t.position.clone(),"start"===n&&(u.startPosition=t.position.clone(),u.startWorldPosition=t.worldPosition.clone(),u.startLocalPosition=t.localPosition.clone(),i[c]=u),"end"===n&&(u=i[c],t.diffPosition=t.position.substract(u.startPosition),t.diffWorldPosition=t.worldPosition.substract(u.startWorldPosition),t.diffLocalPosition=t.localPosition.substract(u.startLocalPosition)),t.id=-1},P=function(t){var e=0;for(e=0;e<c.length;e+=1)if(c[e].id===t.id)return c[e].position=t.position,c[e].worldPosition=t.worldPosition,void(c[e].localPosition=t.position)},O=function(t){var e=0;for(e=0;e<c.length;e+=1)if(c[e].id===t.id)return void c.splice(e,1)},A=function(){r.addEventListener("touchstart",g),r.addEventListener("touchmove",y),r.addEventListener("touchend",b),r.addEventListener("mousedown",v),r.addEventListener("mousemove",w),r.addEventListener("mouseup",x),u=!0,document.body.addEventListener("touchstart",function(t){return t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),!1}),document.body.addEventListener("touchmove",function(t){return t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation(),!1})},M=function(){var t=o.canvas||window,e=function(){t.focus&&t.focus()};t.tabIndex=0,t.focus&&t.focus(),t.addEventListener("keydown",k,!1),t.addEventListener("keyup",E,!1),t.addEventListener("mousedown",e,!1)},k=function(e){var i,o;for(e.preventDefault(),n.fire("keyDown",e),o=t.keyboardMapping[e.keyCode],i=0;i<o.length;++i)h[o[i]]=!0,n.fire("buttonDown",o[i])},E=function(e){var i,o;for(e.preventDefault(),n.fire("keyUp",e),o=t.keyboardMapping[e.keyCode],i=0;i<o.length;++i)h[o[i]]=!1,n.fire("buttonUp",o[i])},j=function(){l=r.offsetLeft,d=r.offsetTop};if(window.addEventListener("resize",j,!1),window.addEventListener("orientationchange",j,!1),!o)throw"Supply a settings object";return s=o.canvasScale,r=o.canvas,a=o.viewport,r&&!t.isCocoonJS()&&(l=r.offsetLeft,d=r.offsetTop),A(),M(),{getPointers:function(){return c},resetPointers:function(){c.length=0},isKeyDown:function(t){return h[t]||!1},stop:function(){u&&(r.removeEventListener("touchstart",g),r.removeEventListener("touchmove",y),r.removeEventListener("touchend",b),r.removeEventListener("mousedown",v),r.removeEventListener("mousemove",w),r.removeEventListener("mouseup",x),u=!1)},resume:function(){u||(r.addEventListener("touchstart",g),r.addEventListener("touchmove",y),r.addEventListener("touchend",b),r.addEventListener("mousedown",v),r.addEventListener("mousemove",w),r.addEventListener("mouseup",x),u=!0)}}}}),bento.define("bento/managers/object",["hshg","bento/utils"],function(t,e){"use strict";return function(n,i){var o,r,s=[],a=(new Date).getTime(),u=0,c=30,h=(new Date).getTime(),l={},d=!1,f=i.sortMode||0,p=!1,m=new t,g=function(){e.stableSort.inplace(s,function(t,e){return t.z-e.z})},y=function(){var t;for(t=s.length-1;t>=0;--t)null===s[t]&&s.splice(t,1)},b=function(t){var n=(new Date).getTime(),s=n-a;if(d){for(i.debug&&r&&r.tickStart(),a=n,u+=s,o.deltaT=s,i.useDeltaT&&(u=1e3/60);u>=1e3/60;){if(u-=1e3/60,u>1e3/c)for(;u>=1e3/60;)u-=1e3/60;i.useDeltaT&&(u=0),v()}y(),f===e.SortMode.ALWAYS&&g(),w(),h=t,i.debug&&r&&r.tick(),requestAnimationFrame(b)}},v=function(){var t,e;for(e=0;e<s.length;++e)t=s[e],t&&t.update&&(p&&t.updateWhenPaused||!p)&&t.update(o);p||(m.update(),m.queryForCollisionPairs())},w=function(){var t,e;for(o.renderer.begin(),e=0;e<s.length;++e)t=s[e],t&&t.draw&&t.draw(o);o.renderer.flush()},x=function(t){var n,i,r;if(t.z=t.z||0,s.push(t),t.init&&t.init(),t.family)for(r=t.family,n=0;n<r.length;++n)i=r[n],l[i]||(l[i]=[]),l[i].push(t);t.useHshg&&t.getAABB&&m.addObject(t),t.start&&t.start(o),t.attached&&t.attached(o),t.isAdded=!0,f===e.SortMode.SORT_ON_ADD&&g()},C={attach:x,add:x,remove:function(t){var n,i,r,a,u;if(t&&(r=s.indexOf(t),r>=0&&(s[r]=null,t.destroy&&t.destroy(o),t.isAdded=!1),t.useHshg&&t.getAABB&&m.removeObject(t),t.family))for(a=t.family,n=0;n<a.length;++n)i=a[n],u=l[i],u&&e.removeObject(l[i],t)},removeAll:function(e){var n,i;for(n=0;n<s.length;++n)i=s[n],i&&(!i.global||e)&&C.remove(i);for(m=new t,y(),n=0;n<s.length;++n)i=s[n],i.useHshg&&i.getAABB&&m.addObject(i)},get:function(t,e){var n,i;for(n=0;n<s.length;++n)if(i=s[n],i&&i.name&&i.name===t)return e&&e(i),i;return null},getByName:function(t,e){var n,i,o=[];for(n=0;n<s.length;++n)i=s[n],i&&i.name&&i.name===t&&o.push(i);return e&&o.length&&e(o),o},getByFamily:function(t,e){var n=l[t];return n||(l[t]=[],n=l[t],console.log("Warning: family called "+t+" does not exist")),e&&n.length&&e(n),n},stop:function(){d=!1},run:function(){d||(d=!0,b())},count:function(){return s.length},pause:function(){p=!0},resume:function(){p=!1},isPaused:function(){return p},draw:function(){w()},getHshg:function(){return m}};return window.performance||(window.performance={now:Date.now}),o=n,i.debug&&e.isDefined(window.FPSMeter)&&(FPSMeter.defaults.graph=1,r=new FPSMeter),i.defaultSort&&(g=defaultSort),C}}),bento.define("bento/managers/savestate",["bento/utils"],function(t){"use strict";var e,n=document.URL,i={data:{},setItem:function(t,e){var n,i=0,o=this.data;o[t]=e;for(n in o)o.hasOwnProperty(n)&&++i;this.length=i},getItem:function(e){var n=i.data[e];return t.isDefined(n)?n:null},removeItem:function(t){delete i.data[t]},clear:function(){this.data={},this.length=0},length:0};try{if(e=window.localStorage,!window.localStorage)throw"No local storage available";window.localStorage.setItem(n+"save","0")}catch(o){console.log("Warning: you have disabled cookies on your browser. You cannot save progress in your game."),e=i}return{saveKeys:!1,save:function(t,i){var o;"string"!=typeof t&&(t=JSON.stringify(t)),e.setItem(n+t,JSON.stringify(i)),this.saveKeys&&(o=this.load("_keys",[]),o.push(t),e.setItem(n+"_keys",JSON.stringify(o)))},load:function(t,i){var o;return o=e.getItem(n+t),null===o||void 0===o?i:JSON.parse(o)},remove:function(t){e.removeItem(n+t)},clear:function(){e.clear()},debug:function(){console.log(localStorage)},isEmpty:function(){return 0===e.length},setId:function(t){n=t},setStorage:function(t){e=t},getStorage:function(){return e}}}),bento.define("bento/managers/screen",["bento/utils"],function(){"use strict";return function(){var t={},e=null,n={add:function(e){if(!e.name)throw"Add name property to screen";t[e.name]=e},show:function(i,o,r){null!==e&&n.hide(),e=t[i],e?(e.onShow&&e.onShow(o),r&&r()):bento.require([i],function(t){t.name||(t.name=i),n.add(t),n.show(i,o,r)})},hide:function(t){e&&(e.onHide(t),e=null)},getCurrentScreen:function(){return e},reset:function(){t={}}};return n}}),bento.define("bento/math/array2d",function(){"use strict";return function(t,e){var n,i,o=[];for(n=0;t>n;++n)for(o[n]=[],i=0;e>i;++i)o[n][i]=null;return{isArray2d:function(){return!0},iterate:function(n){var i,r;for(r=0;e>r;++r)for(i=0;t>i;++i)n(i,r,o[i][r])},get:function(t,e){return o[t][e]},set:function(t,e,n){o[t][e]=n}}}}),bento.define("bento/math/matrix",["bento/utils"],function(t){"use strict";var e=function(t){var e=this.clone();return e.addTo(t),e},n=function(){var t=this.clone();return t.multiplyWith(other),t},i=function(o,r){var s,a,u=[],c=o||0,h=r||0,l=function(t,e,n){u[e*c+t]=n},d=function(t,e){return u[e*c+t]};for(a=0;h>a;++a)for(s=0;c>s;++s)s===a?l(s,a,1):l(s,a,0);return{isMatrix:function(){return!0},stringify:function(){var t,e,n="",i="";for(e=0;h>e;++e){for(t=0;c>t;++t)i+=d(t,e)+"	";n+=i+"\n",i=""}return n},get:function(t,e){return d(t,e)},set:function(t,e,n){l(t,e,n)},setValues:function(t){var e,n=Math.min(u.length,t.length);for(e=0;n>e;++e)u[e]=t[e];return this},getWidth:function(){return c},getHeight:function(){return h},iterate:function(e){var n,i;for(i=0;h>i;++i)for(n=0;c>n;++n){if(!t.isFunction(e))throw"Please supply a callback function";e(n,i,d(n,i))}},transpose:function(){var t,e,n=[];for(t=0;c>t;++t)for(e=0;h>e;++e)n[t*h+e]=d(t,e);return u=n,h=[c,c=h][0],this},addTo:function(t){var e,n;if(h!=t.getHeight()||c!=t.getWidth())throw"Matrix sizes incorrect";for(n=0;h>n;++n)for(e=0;c>e;++e)l(e,n,d(e,n)+t.get(e,n));return this},add:e,multiplyWith:function(t){var e,n,i,o=[],r=c,s=h,a=t.getHeight(),l=t.getWidth(),f=0;if(s!=l)throw"Matrix sizes incorrect";for(n=0;a>n;++n)for(e=0;r>e;++e){for(f=0,i=0;l>i;++i)f+=t.get(i,n)*d(e,i);o[n*r+e]=f}return u=o,c=r,h=a,this},multiply:n,clone:function(){var t=i(c,h);return t.setValues(u),t}}};return i}),bento.define("bento/math/polygon",["bento/utils","bento/math/rectangle"],function(t,e){"use strict";var n=function(){return!0},i=function(){for(var t=[],e=this.points,n=e.length;n--;)t[n]=e[n];return u(t)},o=function(t){for(var e=[],n=this.points,i=n.length;i--;)e[i]=n[i],e[i].x+=t.x,e[i].y+=t.y;return u(e)},r=function(t,e,n,i){var o,r,s=function(t,e){return t.x*e.y-t.y*e.x},a=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},u=a(e,t),c=a(i,n),h=s(a(n,t),u),l=s(u,c);return 0===h&&0===l?n.x-t.x<0!=n.x-e.x<0!=i.x-t.x<0!=i.x-e.x<0||n.y-t.y<0!=n.y-e.y<0!=i.y-t.y<0!=i.y-e.y<0:0===l?!1:(o=h/l,r=s(a(n,t),c)/l,r>=0&&1>=r&&o>=0&&1>=o)},s=function(t){var e,n,i,o,s,a,c=[],h=this.points;if(t.isRectangle){if(!this.getBoundingBox().intersect(t))return!1;c.push({x:t.x,y:t.y}),c.push({x:t.getX2(),y:t.y}),c.push({x:t.getX2(),y:t.getY2()}),c.push({x:t.x,y:t.getY2()}),t=u(c)}else{if(!this.getBoundingBox().intersect(t.getBoundingBox()))return!1;c=t.points}for(s=0;s<h.length;++s)for(a=0;a<c.length;++a)if(e=h[s],n=h[(s+1)%h.length],i=c[a],o=c[(a+1)%c.length],r(e,n,i,o))return!0;return this.hasPosition(c[0])||t.hasPosition(h[0])?!0:!1},a=function(t){var e=this.points,n=!1,i=0,o=e.length-1,r=this.getBoundingBox();if(t.x<r.x||t.x>r.x+r.width||t.y<r.y||t.y>r.y+r.height)return!1;for(o;i<e.length;o=i++)e[i].y>t.y!=e[o].y>t.y&&t.x<(e[o].x-e[i].x)*(t.y-e[i].y)/(e[o].y-e[i].y)+e[i].x&&(n=!n);return n},u=function(t){var r,u=t[0].x,c=t[0].x,h=t[0].y,l=t[0].y,d=1;for(d=1;d<t.length;++d)r=t[d],u=Math.min(r.x,u),c=Math.max(r.x,c),h=Math.min(r.y,h),l=Math.max(r.y,l);return{x:u,y:h,width:c-u,height:l-h,points:t,isPolygon:n,getBoundingBox:function(){return new e(u,h,c-u,l-h)},hasPosition:a,intersect:s,offset:o,clone:i}};return u}),bento.define("bento/math/rectangle",["bento/utils","bento/math/vector2"],function(t,e){"use strict";var n=function(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i};return n.prototype.isRectangle=function(){return!0},n.prototype.getX2=function(){return this.x+this.width},n.prototype.getY2=function(){return this.y+this.height},n.prototype.union=function(t){var e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),o=Math.max(this.getX2(),t.getX2()),r=Math.max(this.getY2(),t.getY2());return new n(e,i,o-e,r-i)},n.prototype.intersect=function(t){return t.isPolygon?t.intersect(this):!(this.x+this.width<=t.x||this.y+this.height<=t.y||this.x>=t.x+t.width||this.y>=t.y+t.height)},n.prototype.intersection=function(t){var e=new n(0,0,0,0);return this.intersect(t)&&(e.x=Math.max(this.x,t.x),e.y=Math.max(this.y,t.y),e.width=Math.min(this.x+this.width,t.x+t.width)-e.x,e.height=Math.min(this.y+this.height,t.y+t.height)-e.y),e},n.prototype.offset=function(t){return new n(this.x+t.x,this.y+t.y,this.width,this.height)},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.hasPosition=function(t){return!(t.x<this.x||t.y<this.y||t.x>=this.x+this.width||t.y>=this.y+this.height)},n.prototype.grow=function(t,e,n){return e||(this.x-=t/2,this.width+=t),n||(this.y-=t/2,this.height+=t),this},n.prototype.getCorner=function(t){return t?1===t?new e(this.x+this.width,this.y):2===t?new e(this.x,this.y+this.height):3===t?new e(this.x+this.width,this.y+this.height):new e(this.x+this.width/2,this.y,this.height/2):new e(this.x,this.y)},n.prototype.toString=function(){return"[object Rectangle]"},n}),bento.define("bento/math/vector2",["bento/math/matrix"],function(t){"use strict";var e=function(t,e){this.x=t||0,this.y=e||0};return e.prototype.isVector2=function(){return!0},e.prototype.add=function(t){var e=this.clone();return e.addTo(t),e},e.prototype.addTo=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.substract=function(t){var e=this.clone();return e.substractFrom(t),e},e.prototype.substractFrom=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.angle=function(){return Math.atan2(this.y,this.x)},e.prototype.angleBetween=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},e.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},e.prototype.multiply=function(t){var e=this.clone();return e.multiplyWith(t),e},e.prototype.multiplyWith=function(t){return this.x*=t.x,this.y*=t.y,this},e.prototype.divide=function(t){var e=this.clone();return e.divideBy(t),e},e.prototype.divideBy=function(t){return this.x/=t.x,this.y/=t.y,this},e.prototype.scalarMultiply=function(t){var e=this.clone();return e.scalarMultiplyWith(t),e},e.prototype.scalarMultiplyWith=function(t){return this.x*=t,this.y*=t,this},e.prototype.scale=function(t){return this.x*=t,this.y*=t,this},e.prototype.magnitude=function(){return Math.sqrt(this.dotProduct(this))},e.prototype.normalize=function(){var t=this.magnitude();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){return t.substract(this).magnitude()},e.prototype.fartherThan=function(t,e){var n=t.substract(this);return n.x*n.x+n.y*n.y>e*e},e.prototype.rotateRadian=function(t){var e=this.x*Math.cos(t)-this.y*Math.sin(t),n=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=n,this},e.prototype.rotateDegree=function(t){return this.rotateRadian(t*Math.PI/180)},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.toMatrix=function(){var e=new t(1,3);return e.set(0,0,this.x),e.set(0,1,this.y),e.set(0,2,1),e},e.prototype.reflect=function(t){var e=t.normalize(),n=this.dotProduct(e);return this.substractFrom(e.scalarMultiplyWith(n+n))},e.prototype.toString=function(){return"[object Vector2]"},e}),bento.define("bento/autoresize",["bento/utils"],function(){return function(t,e,n,i){var o=t.clone(),r=window.innerWidth,s=window.innerHeight,a=i?r:s,u=i?s:r,c=function(){temp=t.width,t.width=t.height,t.height=temp},h=function(){var r,s=2,h=t.height,l=a/u,d=t.height/t.width;for(1>l?(d=l,r=a):(d=u/a,r=u),h=r,r*=window.devicePixelRatio||1,console.log(r);h>n;)if(h=Math.floor(r/s),s+=1,e>h){h=i?o.height:o.width;break}return t.width=h/d,t.height=h,i||c(),t},l=function(){window.scrollTo(0,0)};return window.addEventListener("orientationchange",l,!1),i||c(),h()}}),bento.define("bento/screen",["bento/utils","bento","bento/math/rectangle","bento/tiled"],function(t,e,n,i){"use strict";return function(n){var o,r=e.getViewport(),s={name:null,dimension:n&&n.dimension?n.dimension:r.clone(),extend:function(e){return t.extend(this,e)},loadTiled:function(t){o=i({name:t,spawn:!0}),this.dimension=o.dimension},onShow:function(t){n&&(n.tiled&&this.loadTiled(n.tiled),n.onShow&&n.onShow(t))},onHide:function(t){e.removeAll(),r.x=0,r.y=0,n.onHide&&n.onHide(t)}};return s}}),bento.define("bento/tiled",["bento","bento/entity","bento/components/sprite","bento/math/vector2","bento/math/rectangle","bento/math/polygon","bento/packedimage","bento/utils"],function(t,e,n,i,o,r,s,a){"use strict";return function(u){var c,h,l,d,f,p,m=t.assets.getJson(u.name),g=m.width,y=m.height,b=m.layers.length,v=m.tilewidth,w=m.tileheight,x=document.createElement("canvas"),C=x.getContext("2d"),S=[],P=[],O=(t.getViewport(),function(t){var e,n,i=null;for(e=0;e<m.tilesets.length;++e)n=m.tilesets[e],n.firstgid<=t&&(i=n);return i}),A=function(e,n){var i,o,r;return null===e?null:(i=n-e.firstgid,o=Math.floor(e.imagewidth/e.tilewidth),r=Math.floor(e.imageheight/e.tileheight),{subimage:t.assets.getImage(e.name),x:i%o*e.tilewidth,y:Math.floor(i/o)*e.tileheight,width:e.tilewidth,height:e.tileheight})},M=function(t,e){var n=d.data[e*g+t],i=O(n),o=A(i,n);o&&C.drawImage(o.subimage.image,o.subimage.x+o.x,o.subimage.y+o.y,o.width,o.height,t*v,e*w,v,w)},k=function(e,n,o){var r=n.x,s=n.y,c={};a.extend(c,o),a.extend(c,n.properties),bento.require([e],function(e){var n=e.apply(this,[c]),o=n.origin,a=n.dimension;n.position=new i(r+o.x,s+(o.y-a.height)),u.spawn&&t.objects.add(n),S.push(n)})},E=function(t){var e,n,i=t.gid,o=O(i),r=i-o.firstgid;o.tileproperties&&(e=o.tileproperties[r.toString()],e&&(n=e.module)),n&&k(n,t,e)},j=function(n,i){var o;u.spawn&&(o=new e({z:0,name:i,family:[i],useHshg:!0,staticHshg:!0}),o.update=null,o.draw=null,o.boundingBox=n,t.objects.add(o)),n.type=i,P.push(o)};for(x.width=g*v,x.height=y*w,l=0;b>l;++l)if(d=m.layers[l],"tilelayer"===d.type)for(h=0;h<d.height;++h)for(c=0;c<d.width;++c)M(c,h);else if("objectgroup"===d.type)for(c=0;c<d.objects.length;++c)if(f=d.objects[c],""===f.type&&(f.type="solid"),f.gid)E(f);else if(f.polygon){for(p=[],h=0;h<f.polygon.length;++h)p.push({x:f.polygon[h].x+f.x,y:f.polygon[h].y+f.y+1});j(r(p),f.type)}else j(new o(f.x,f.y,f.width,f.height),f.type);var I=s(x),_=new e({z:0,name:"",useHshg:!1,position:new i(0,0),originRelative:new i(0,0),components:[new n({image:I})],family:[""]});return u.spawn&&t.objects.add(_),{tileLayer:_,objects:S,shapes:P,dimension:new o(0,0,v*g,w*y),moveTo:function(t){this.tileLayer.position=t;for(var e=0,n=P.length;n>e;e++)P[e].x+=t.x,P[e].y+=t.y;for(e=0,n=S.length;n>e;e++)S[e].offset(t)},remove:function(){t.objects.remove(this.tileLayer);for(var e=0,n=P.length;n>e;e++)t.objects.remove(P[e]);for(P.length=0,e=0,n=S.length;n>e;e++)t.objects.remove(S[e]);S.length=0}}}}),bento.define("bento/tween",["bento","bento/utils","bento/entity"],function(t,e,n){"use strict";var i={easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0===t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t===i?e+n:n*(-Math.pow(2,-10*t/i)+1)+e},easeInOutExpo:function(t,e,n,i){return 0===t?e:t===i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,i){var o=1.70158,r=0,s=n;return 0===t?e:1===(t/=i)?e+n:(r||(r=.3*i),s<Math.abs(n)?(s=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/r))+e)},easeOutElastic:function(t,e,n,i){var o=1.70158,r=0,s=n;return 0===t?e:1===(t/=i)?e+n:(r||(r=.3*i),s<Math.abs(n)?(s=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/s),s*Math.pow(2,-10*t)*Math.sin(2*(t*i-o)*Math.PI/r)+n+e)},easeInOutElastic:function(t,e,n,i){var o=1.70158,r=0,s=n;return 0===t?e:2===(t/=i/2)?e+n:(r||(r=.3*i*1.5),s<Math.abs(n)?(s=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/r)+e:s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-o)*Math.PI/r)*.5+n+e)},easeInBack:function(t,e,n,i,o){return void 0===o&&(o=1.70158),n*(t/=i)*t*((o+1)*t-o)+e},easeOutBack:function(t,e,n,i,o){return void 0===o&&(o=1.70158),n*((t=t/i-1)*t*((o+1)*t+o)+1)+e},easeInOutBack:function(t,e,n,i,o){return void 0===o&&(o=1.70158),(t/=i/2)<1?n/2*t*t*(((o*=1.525)+1)*t-o)+e:n/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+e},easeInBounce:function(t,e,n,i){return n-this.easeOutBounce(i-t,0,n,i)+e},easeOutBounce:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,i){return i/2>t?.5*this.easeInBounce(2*t,0,n,i)+e:.5*this.easeOutBounce(2*t-i,0,n,i)+.5*n+e}},o={linear:function(t,e,n){return(e-t)*n+t},quadratic:function(t,e,n){return(e-t)*n*n+t},squareroot:function(t,e,n){return(e-t)*Math.pow(n,.5)+t},cubic:function(t,e,n){return(e-t)*n*n*n+t},cuberoot:function(t,e,n){return(e-t)*Math.pow(n,1/3)+t},exponential:function(t,e,n,i){return(e-t)/(Math.exp(i)-1)*Math.exp(i*n)+t-(e-t)/(Math.exp(i)-1)},elastic:function(t,e,n,i,o){return(e-t)/(Math.exp(i)-1)*Math.cos(o*n*2*Math.PI)*Math.exp(i*n)+t-(e-t)/(Math.exp(i)-1)},sin:function(t,e,n,i){return t+e*Math.sin(i*n*2*Math.PI)},cos:function(t,e,n,i){return t+e*Math.cos(i*n*2*Math.PI)}},r=function(t,e,n,r,s,a){var u=o[t];return u?u(e,n,r,s,a):i[t](r,e,n-e,1)};return function(i){var o=0,s=!1,a=!0,u=new n(i).extend({id:i.id,update:function(){a&&(++o,i["do"]&&i["do"].apply(this,[r(i.ease||"linear",i.from||0,e.isDefined(i.to)?i.to:1,o/i["in"],e.isDefined(i.alpha)?i.alpha:1,e.isDefined(i.beta)?i.beta:1),o]),!i.stay&&o>=i["in"]&&(i.onComplete&&i.onComplete.apply(this),t.objects.remove(u),s=!1))},begin:function(){return o=0,s||(t.objects.add(u),s=!0),a=!0,u},stop:function(){return o=0,a=!1,u}});return 0===i["in"]&&(i["in"]=1),u.begin(),u}}),bento.define("bento/components/animation",["bento","bento/utils"],function(t,e){"use strict";var n=function(t){this.entity=null,this.name="animation",this.visible=!0,this.animationSettings=t||{frameCountX:1,frameCountY:1},this.spriteImage=null,this.frameCountX=1,this.frameCountY=1,this.frameWidth=0,this.frameHeight=0,this.animations={},this.currentAnimation=null,this.onCompleteCallback=function(){},this.setup(t)};return n.prototype.setup=function(n){if(this.animationSettings=n||this.animationSettings,this.animations["default"]||(this.animationSettings.animations||(this.animationSettings.animations={}),this.animationSettings.animations["default"]||(this.animationSettings.animations["default"]={frames:[0]})),n.image)this.spriteImage=n.image;else{if(!n.imageName)return;if(!t.assets)throw"Bento asset manager not loaded";this.spriteImage=t.assets.getImage(n.imageName)}this.animationSettings.frameWidth?(this.frameWidth=this.animationSettings.frameWidth,this.frameCountX=Math.floor(this.spriteImage.width/this.frameWidth)):(this.frameCountX=this.animationSettings.frameCountX||1,this.frameWidth=this.spriteImage.width/this.frameCountX),this.animationSettings.frameHeight?(this.frameHeight=this.animationSettings.frameHeight,this.frameCountY=Math.floor(this.spriteImage.height/this.frameHeight)):(this.frameCountY=this.animationSettings.frameCountY||1,this.frameHeight=this.spriteImage.height/this.frameCountY),e.extend(this.animations,this.animationSettings.animations,!0),this.setAnimation("default"),this.entity&&(this.entity.dimension.width=this.frameWidth,this.entity.dimension.height=this.frameHeight)},n.prototype.attached=function(t){this.entity=t.entity,this.entity.dimension.width=this.frameWidth,this.entity.dimension.height=this.frameHeight},n.prototype.setAnimation=function(t,n,i){var o=this.animations[t];return o?void(o&&(this.currentAnimation!==o||null!==this.onCompleteCallback&&e.isDefined(n))&&(e.isDefined(o.loop)||(o.loop=!0),e.isDefined(o.backTo)||(o.backTo=0),this.onCompleteCallback=n,this.currentAnimation=o,this.currentAnimation.name=t,i||(this.currentFrame=0))):void console.log("Warning: animation "+t+" does not exist.")},n.prototype.getAnimationName=function(){return this.currentAnimation.name},n.prototype.setFrame=function(t){this.currentFrame=t},n.prototype.getCurrentSpeed=function(){return this.currentAnimation.speed},n.prototype.setCurrentSpeed=function(t){this.currentAnimation.speed=t},n.prototype.getCurrentFrame=function(){return this.currentFrame},n.prototype.getFrameWidth=function(){return this.frameWidth},n.prototype.update=function(){var t;if(this.currentAnimation){if(t=!1,this.currentFrame+=this.currentAnimation.speed||1,this.currentAnimation.loop)for(;this.currentFrame>=this.currentAnimation.frames.length;)this.currentFrame-=this.currentAnimation.frames.length-this.currentAnimation.backTo,t=!0;else this.currentFrame>=this.currentAnimation.frames.length&&(t=!0);t&&this.onCompleteCallback&&this.onCompleteCallback()}},n.prototype.draw=function(t){var e,n,i,o=t.entity,r=o.origin;this.currentAnimation&&this.visible&&(e=Math.min(Math.floor(this.currentFrame),this.currentAnimation.frames.length-1),n=this.currentAnimation.frames[e]%this.frameCountX*this.frameWidth,i=Math.floor(this.currentAnimation.frames[e]/this.frameCountX)*this.frameHeight,t.renderer.translate(Math.round(-r.x),Math.round(-r.y)),t.renderer.drawImage(this.spriteImage,n,i,this.frameWidth,this.frameHeight,0,0,this.frameWidth,this.frameHeight),t.renderer.translate(Math.round(r.x),Math.round(r.y)))},n.prototype.toString=function(){return"[object Animation]"},n}),bento.define("bento/components/clickable",["bento","bento/utils","bento/math/vector2","bento/math/matrix","bento/eventsystem"],function(t,e,n,i,o){"use strict";var r=function(t){this.entity=null,this.name="clickable",this.isHovering=!1,this.hasTouched=!1,this.holdId=null,this.isPointerDown=!1,this.initialized=!1,this.callbacks={pointerDown:t.pointerDown||function(){},pointerUp:t.pointerUp||function(){},pointerMove:t.pointerMove||function(){},onClick:t.onClick||function(){},onClickUp:t.onClickUp||function(){},onClickMiss:t.onClickMiss||function(){},onHold:t.onHold||function(){},onHoldLeave:t.onHoldLeave||function(){},onHoldEnter:t.onHoldEnter||function(){},onHoldEnd:t.onHoldEnd||function(){},onHoverLeave:t.onHoverLeave||function(){},onHoverEnter:t.onHoverEnter||function(){}}};return r.prototype.destroy=function(){o.removeEventListener("pointerDown",this.pointerDown,this),o.removeEventListener("pointerUp",this.pointerUp,this),o.removeEventListener("pointerMove",this.pointerMove,this),this.initialized=!1},r.prototype.start=function(){this.initialized||(o.addEventListener("pointerDown",this.pointerDown,this),o.addEventListener("pointerUp",this.pointerUp,this),o.addEventListener("pointerMove",this.pointerMove,this),this.initialized=!0)},r.prototype.update=function(){this.isHovering&&this.callbacks.isPointerDown&&this.callbacks.onHold&&this.callbacks.onHold()},r.prototype.cloneEvent=function(t){return{id:t.id,position:t.position.clone(),eventType:t.eventType,localPosition:t.localPosition.clone(),worldPosition:t.worldPosition.clone()}},r.prototype.pointerDown=function(e){var n=this.transformEvent(e);t.objects&&t.objects.isPaused()&&!this.entity.updateWhenPaused||(this.isPointerDown=!0,this.callbacks.pointerDown&&this.callbacks.pointerDown.call(this,n),this.entity.getBoundingBox&&this.checkHovering(n,!0))},r.prototype.pointerUp=function(e){var n,i=this.transformEvent(e);t.objects&&t.objects.isPaused()&&!this.entity.updateWhenPaused||(n=i.localPosition,this.isPointerDown=!1,this.callbacks.pointerUp&&this.callbacks.pointerUp.call(this,i),this.entity.getBoundingBox().hasPosition(n)&&(this.callbacks.onClickUp.call(this,[i]),this.hasTouched&&this.holdId===i.id&&(this.holdId=null,this.callbacks.onHoldEnd.call(this,i))),this.hasTouched=!1)},r.prototype.pointerMove=function(e){var n=this.transformEvent(e);t.objects&&t.objects.isPaused()&&!this.entity.updateWhenPaused||(this.callbacks.pointerMove&&this.callbacks.pointerMove.call(this,n),this.entity.getBoundingBox&&this.checkHovering(n))},r.prototype.checkHovering=function(t,e){var n=t.localPosition;this.entity.getBoundingBox().hasPosition(n)?(this.hasTouched&&!this.isHovering&&this.holdId===t.id&&this.callbacks.onHoldEnter.call(this,t),this.isHovering||this.callbacks.onHoverEnter.call(this,t),this.isHovering=!0,e&&(this.hasTouched=!0,this.holdId=t.id,this.callbacks.onClick.call(this,t))):(this.hasTouched&&this.isHovering&&this.holdId===t.id&&this.callbacks.onHoldLeave.call(this,t),this.isHovering&&this.callbacks.onHoverLeave.call(this,t),this.isHovering=!1,e&&this.callbacks.onClickMiss.call(this,t))},r.prototype.transformEvent=function(t){var e,n,o,r,s,a,u=new i(3,3),c=new i(3,3),h=new i(3,3),l=[];if(!this.entity.parent)return t.localPosition=this.entity["float"]?t.position.clone():t.worldPosition.clone(),t;for(t=this.cloneEvent(t),e=this.entity["float"]?t.localPosition.toMatrix():t.worldPosition.toMatrix(),s=this.entity;s.parent;)s=s.parent,l.unshift(s);for(a=0;a<l.length;++a)s=l[a],s.position&&(r=s.position,u.set(2,0,-r.x),u.set(2,1,-r.y),e.multiplyWith(u)),s.rotation&&(n=Math.sin(-s.rotation),o=Math.cos(-s.rotation),h.set(0,0,o),h.set(1,0,-n),h.set(0,1,n),h.set(1,1,o),e.multiplyWith(h)),s.scale&&(c.set(0,0,1/s.scale.x),c.set(1,1,1/s.scale.y),e.multiplyWith(c));return t.localPosition.x=e.get(0,0),t.localPosition.y=e.get(0,1),t},r.prototype.attached=function(t){this.entity=t.entity},r.prototype.toString=function(){return"[object Clickable]"},r}),bento.define("bento/components/fill",["bento/utils","bento"],function(t,e){"use strict";var n=function(t){var n=e.getViewport();t=t||{},this.name="fill",this.color=t.color||[0,0,0,1],this.dimension=t.dimension||n};return n.prototype.draw=function(t){var e=this.dimension;t.renderer.fillRect(this.color,e.x,e.y,e.width,e.height)},n.prototype.setup=function(t){this.color=t.color},n.prototype.toString=function(){return"[object Fill]"},n}),bento.define("bento/components/opacity",["bento/utils","bento/math/vector2"],function(){"use strict";var t=1,e=function(t){t=t||{},this.name="opacity",this.set=!1,this.opacity=t.opacity||1};return e.prototype.draw=function(e){this.set&&(t=e.renderer.getOpacity(),e.renderer.setOpacity(this.opacity))},e.prototype.postDraw=function(e){e.renderer.setOpacity(t)},e.prototype.setOpacity=function(t){this.set=!0,this.opacity=t},e.prototype.getOpacity=function(){return this.opacity},e.prototype.toString=function(){return"[object Opacity]"},e}),bento.define("bento/components/pixi",["bento","bento/utils"],function(t,e){"use strict";if(!window.PIXI)return console.log("Warning: PIXI is not available"),function(){};var n=function(t){this.pixiBaseTexture=null,this.pixiTexture=null,this.pixiSprite=null,this.opacityComponent=null,this.entity=null,this.name="animation",this.visible=!0,this.animationSettings=t||{frameCountX:1,frameCountY:1},this.spriteImage=null,this.frameCountX=1,this.frameCountY=1,this.frameWidth=0,this.frameHeight=0,this.animations={},this.currentAnimation=null,this.onCompleteCallback=function(){},this.setup(t)
};return n.prototype.setup=function(n){var i;if(this.animationSettings=n||this.animationSettings,this.animations["default"]||(this.animationSettings.animations||(this.animationSettings.animations={}),this.animationSettings.animations["default"]||(this.animationSettings.animations["default"]={frames:[0]})),n.image)this.spriteImage=n.image;else{if(!n.imageName)return;if(!t.assets)throw"Bento asset manager not loaded";this.spriteImage=t.assets.getImage(n.imageName)}this.animationSettings.frameWidth?(this.frameWidth=this.animationSettings.frameWidth,this.frameCountX=Math.floor(this.spriteImage.width/this.frameWidth)):(this.frameCountX=this.animationSettings.frameCountX||1,this.frameWidth=this.spriteImage.width/this.frameCountX),this.animationSettings.frameHeight?(this.frameHeight=this.animationSettings.frameHeight,this.frameCountY=Math.floor(this.spriteImage.height/this.frameHeight)):(this.frameCountY=this.animationSettings.frameCountY||1,this.frameHeight=this.spriteImage.height/this.frameCountY),e.extend(this.animations,this.animationSettings.animations,!0),this.setAnimation("default"),this.entity&&(this.entity.dimension.width=this.frameWidth,this.entity.dimension.height=this.frameHeight),this.spriteImage&&(this.spriteImage.image.texture||(this.spriteImage.image.texture=new PIXI.BaseTexture(this.spriteImage.image,PIXI.SCALE_MODES.NEAREST)),this.pixiBaseTexture=this.spriteImage.image.texture,i=new PIXI.Rectangle(this.spriteImage.x,this.spriteImage.y,this.frameWidth,this.frameHeight),this.pixiTexture=new PIXI.Texture(this.pixiBaseTexture,i),this.pixiSprite=new PIXI.Sprite(this.pixiTexture))},n.prototype.attached=function(t){this.entity=t.entity,this.entity.dimension.width=this.frameWidth,this.entity.dimension.height=this.frameHeight,this.opacityComponent=t.entity.getComponent("opacity")},n.prototype.setAnimation=function(t,n,i){var o=this.animations[t];return o?void(o&&(this.currentAnimation!==o||null!==this.onCompleteCallback&&e.isDefined(n))&&(e.isDefined(o.loop)||(o.loop=!0),e.isDefined(o.backTo)||(o.backTo=0),this.onCompleteCallback=n,this.currentAnimation=o,this.currentAnimation.name=t,i||(this.currentFrame=0))):void console.log("Warning: animation "+t+" does not exist.")},n.prototype.getAnimationName=function(){return this.currentAnimation.name},n.prototype.setFrame=function(t){this.currentFrame=t},n.prototype.setCurrentSpeed=function(t){this.currentAnimation.speed=t},n.prototype.getCurrentFrame=function(){return this.currentFrame},n.prototype.getFrameWidth=function(){return this.frameWidth},n.prototype.update=function(){var t;if(this.currentAnimation){if(t=!1,this.currentFrame+=this.currentAnimation.speed||1,this.currentAnimation.loop)for(;this.currentFrame>=this.currentAnimation.frames.length;)this.currentFrame-=this.currentAnimation.frames.length-this.currentAnimation.backTo,t=!0;else this.currentFrame>=this.currentAnimation.frames.length&&(t=!0);t&&this.onCompleteCallback&&this.onCompleteCallback()}},n.prototype.draw=function(t){var e,n,i,o,r=t.entity.origin,s=t.entity.position,a=t.entity.rotation,u=t.entity.scale;this.currentAnimation&&this.pixiSprite&&this.visible&&(n=Math.min(Math.floor(this.currentFrame),this.currentAnimation.frames.length-1),i=this.currentAnimation.frames[n]%this.frameCountX*this.frameWidth,o=Math.floor(this.currentAnimation.frames[n]/this.frameCountX)*this.frameHeight,e=new PIXI.Rectangle(this.spriteImage.x+i,this.spriteImage.y+o,this.frameWidth,this.frameHeight),this.pixiTexture.frame=e,this.pixiSprite.x=s.x,this.pixiSprite.y=s.y,this.pixiSprite.anchor.x=r.x/this.frameWidth,this.pixiSprite.anchor.y=r.y/this.frameHeight,t.entity["float"]&&(this.pixiSprite.x-=viewport.x,this.pixiSprite.y-=viewport.y),this.pixiSprite.scale.x=u.x,this.pixiSprite.scale.y=u.y,this.pixiSprite.rotation=a,this.opacityComponent&&(this.pixiSprite.alpha=this.opacityComponent.getOpacity()),this.pixiSprite.visible=t.entity.visible,this.pixiSprite.z=t.entity.z)},n.prototype.destroy=function(){this.pixiSprite&&this.pixiSprite.parent&&this.pixiSprite.parent.removeChild(this.pixiSprite)},n.prototype.start=function(){return this.pixiSprite?void 0:void console.log("call setup first")},n.prototype.onParentAttached=function(t){var e;this.pixiSprite||(console.log("Warning: pixi sprite does not exist, creating pixi container"),this.pixiSprite=new PIXI.Container),t.renderer?t.renderer.addChild(this.pixiSprite):t.entity&&(e=t.entity.parent,e&&e.getComponent("animation",function(t){t.pixiSprite||(console.log("Warning: pixi sprite does not exist, creating pixi container"),t.pixiSprite=new PIXI.Container),t.pixiSprite.addChild(this.pixiSprite)}))},n.prototype.toString=function(){return"[object Pixi]"},n}),bento.define("bento/components/rotation",["bento/utils"],function(){"use strict";var t=function(t){t=t||{},this.name="rotation",this.entity=null};return t.prototype.draw=function(t){t.renderer.save(),t.renderer.rotate(t.entity.rotation)},t.prototype.postDraw=function(t){t.renderer.restore()},t.prototype.attached=function(t){this.entity=t.entity},t.prototype.addAngleDegree=function(t){this.entity.rotation+=t*Math.PI/180},t.prototype.addAngleRadian=function(t){this.entity.rotation+=t},t.prototype.setAngleDegree=function(t){this.entity.rotation=t*Math.PI/180},t.prototype.setAngleRadian=function(t){this.entity.rotation=t},t.prototype.getAngleDegree=function(){return 180*this.entity.rotation/Math.PI},t.prototype.getAngleRadian=function(){return this.entity.rotation},t.prototype.toString=function(){return"[object Rotation]"},t}),bento.define("bento/components/scale",["bento/utils","bento/math/vector2"],function(){"use strict";var t=function(){this.entity=null,this.name="scale"};return t.prototype.draw=function(t){t.renderer.scale(t.entity.scale.x,t.entity.scale.y)},t.prototype.attached=function(t){this.entity=t.entity},t.prototype.toString=function(){return"[object Scale]"},t}),bento.define("bento/components/sprite",["bento","bento/utils","bento/components/translation","bento/components/rotation","bento/components/scale","bento/components/opacity","bento/components/animation","bento/components/pixi"],function(t,e,n,i,o,r,s,a){"use strict";var u,c=function(e){this.entity=null,u||(u=t.getRenderer()),"pixi"===u.name?(this.opacity=new r(e),this.animation=new a(e)):(this.translation=new n(e),this.rotation=new i(e),this.scale=new o(e),this.opacity=new r(e),this.animation=new s(e)),this.components=e.components||[]};return c.prototype.attached=function(t){var e=0;for(this.entity=t.entity,this.translation&&this.entity.attach(this.translation),this.rotation&&this.entity.attach(this.rotation),this.scale&&this.entity.attach(this.scale),this.entity.attach(this.opacity),e=0;e<this.components.length;++e)this.entity.attach(this.components[e]);this.entity.attach(this.animation),this.entity.remove(this)},c.prototype.insertBefore=function(t){return e.isArray(t)||(t=[t]),this.components=t,this},c.prototype.toString=function(){return"[object Sprite]"},c}),bento.define("bento/components/translation",["bento/utils","bento/math/vector2"],function(){"use strict";var t=function(t){t=t||{},this.name="translation",this.subPixel=t.subPixel||!1,this.entity=null,this.x=0,this.y=0};return t.prototype.draw=function(t){var e=t.entity,n=e.parent,i=(e.position,e.origin,t.viewport);t.renderer.save(),this.subPixel?t.renderer.translate(e.position.x+this.x,e.position.y+this.y):t.renderer.translate(Math.round(e.position.x+this.x),Math.round(e.position.y+this.y)),n||e["float"]||t.renderer.translate(-i.x,-i.y)},t.prototype.postDraw=function(t){t.renderer.restore()},t.prototype.attached=function(t){this.entity=t.entity},t.prototype.toString=function(){return"[object Translation]"},t}),bento.define("bento/renderers/canvas2d",["bento/utils"],function(){return function(t,e){var n=t.getContext("2d"),i=n,o=e.pixelSize||1,r={name:"canvas2d",save:function(){n.save()},restore:function(){n.restore()},translate:function(t,e){n.translate(t,e)},scale:function(t,e){n.scale(t,e)},rotate:function(t){n.rotate(t)},fillRect:function(t,e,i,o,r){var a=s(t),u=n.globalAlpha;1!==t[3]&&(n.globalAlpha=t[3]),n.fillStyle=a,n.fillRect(e,i,o,r),1!==t[3]&&(n.globalAlpha=u)},fillCircle:function(t,e,i,o){{var r=s(t);n.globalAlpha}1!==t[3]&&(n.globalAlpha=t[3]),n.fillStyle=r,n.beginPath(),n.arc(e,i,o,0,2*Math.PI),n.fill(),n.closePath()},strokeRect:function(t,e,i,o,r){var a=s(t),u=n.globalAlpha;1!==t[3]&&(n.globalAlpha=t[3]),n.strokeStyle=a,n.strokeRect(e,i,o,r),1!==t[3]&&(n.globalAlpha=u)},drawImage:function(t,e,i,o,r,s,a,u,c){n.drawImage(t.image,t.x+e,t.y+i,o,r,s,a,u,c)},getOpacity:function(){return n.globalAlpha},setOpacity:function(t){n.globalAlpha=t},createSurface:function(e,n){var i,o=document.createElement("canvas");return o.width=e,o.height=n,i=t.getContext("2d"),{canvas:o,context:i}},setContext:function(t){n=t},restoreContext:function(){n=i},begin:function(){n===i&&1!==o&&(n.save(),n.scale(o,o))},flush:function(){n===i&&1!==o&&n.restore()}},s=function(t){var e="#";return e+=("00"+Math.floor(255*t[0]).toString(16)).slice(-2),e+=("00"+Math.floor(255*t[1]).toString(16)).slice(-2),e+=("00"+Math.floor(255*t[2]).toString(16)).slice(-2)};return console.log("Init canvas2d as renderer"),t.width*=o,t.height*=o,e.smoothing||(n.imageSmoothingEnabled&&(n.imageSmoothingEnabled=!1),n.webkitImageSmoothingEnabled&&(n.webkitImageSmoothingEnabled=!1),n.mozImageSmoothingEnabled&&(n.mozImageSmoothingEnabled=!1)),r}}),bento.define("bento/renderers/pixi",["bento","bento/utils"],function(t,e){return function(n,i){var o,r,s=i.sortMode||0,a={name:"pixi",init:function(){},destroy:function(){},save:function(){},restore:function(){},translate:function(){},scale:function(){},rotate:function(){},fillRect:function(){},fillCircle:function(){},drawImage:function(){},begin:function(){s===e.SortMode.ALWAYS&&u()},flush:function(){var e=t.getViewport();o.x=-e.x,o.y=-e.y,r.render(o)},addChild:function(t){o.addChild(t),s===e.SortMode.SORT_ON_ADD&&u()},removeChild:function(t){o.removeChild(t)}},u=function(){e.stableSort.inplace(o.children,function(t,e){return t.z-e.z})};if(!window.PIXI)throw"Pixi library missing";return o=new PIXI.Container,r=PIXI.autoDetectRenderer(n.width,n.height,{view:n,backgroundColor:0}),console.log("Init pixi as renderer"),console.log(r.view===n),a}}),bento.define("bento/renderers/webgl",["bento/utils","bento/renderers/canvas2d"],function(t,e){return function(n,i){var o,r,s,a=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),u=i.pixelSize||1,c={name:"webgl",save:function(){r.save()},restore:function(){r.restore()},translate:function(t,e){r.translate(t,e)},scale:function(t,e){r.scale(t,e)},rotate:function(t){r.rotate(t)},fillRect:function(t,e,n,i,o){var s=r.color;c.setColor(t),r.fillRect(e,n,i,o),r.color=s},fillCircle:function(){},strokeRect:function(t,e,n,i,o){var s=r.color;c.setColor(t),r.strokeRect(e,n,i,o),r.color=s},drawImage:function(t,e,n,i,s,a,u){var c=t.image;c.texture||(c.texture=window.GlSprites.createTexture2D(o,c)),r.drawImage(c.texture,t.x+e,t.y+n,i,s,a,u,i,s)},begin:function(){r.begin()},flush:function(){r.end()},setColor:function(t){r.color=t},getOpacity:function(){return r.color[3]},setOpacity:function(t){r.color[3]=t},createSurface:function(t,e){var i,o,r=document.createElement("canvas");return r.width=t,r.height=e,i=n.getContext("webgl")||n.getContext("experimental-webgl"),o=new window.GlSprites.SpriteRenderer(i),o.ortho(n.width,n.height),{canvas:r,context:o}},setContext:function(t){r=t},restoreContext:function(){r=s}};return console.log("Init webgl as renderer"),a&&t.isDefined(window.GlSprites)?(n.width*=u,n.height*=u,o=n.getContext("webgl")||n.getContext("experimental-webgl"),r=new window.GlSprites.SpriteRenderer(o),r.ortho(n.width/u,n.height/u),s=r,c):(console.log("webgl failed, revert to canvas"),e(n,i))}}),bento.define("bento/gui/clickbutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween","bento/eventsystem"],function(t,e,n,i,o,r,s,a,u){"use strict";return function(n){var a=(t.getViewport(),!0),c=new i({image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]},inactive:{speed:0,frames:[2]}}}),h=new o({onClick:function(){a&&(c.animation.setAnimation("down"),n.onButtonDown&&n.onButtonDown.apply(d))},onHoldEnter:function(){a&&(c.animation.setAnimation("down"),n.onButtonDown&&n.onButtonDown.apply(d))},onHoldLeave:function(){a&&(c.animation.setAnimation("up"),n.onButtonUp&&n.onButtonUp.apply(d))},pointerUp:function(){a&&(c.animation.setAnimation("up"),n.onButtonUp&&n.onButtonUp.apply(d))},onHoldEnd:function(){a&&n.onClick&&(n.onClick.apply(d),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx)),u.fire("clickButton",d))}}),l=s.extend({z:0,name:"",originRelative:new e(.5,.5),position:new e(0,0),components:[c,h],family:["buttons"],init:function(){c.animation.setAnimation(a?"up":"inactive")}},n),d=new r(l).extend({setActive:function(t){a=t,c.animation.setAnimation(a?"up":"inactive")},doCallback:function(){n.onClick.apply(d)}});return s.isDefined(n.active)&&(a=n.active),d}}),bento.define("bento/gui/counter",["bento","bento/entity","bento/math/vector2","bento/components/sprite","bento/components/translation","bento/components/rotation","bento/components/scale","bento/utils"],function(t,e,n,i,o,r,s,a){"use strict";return function(t){var o,r=t.value||0,s=t.spacing||new n(0,0),u=t.align||t.alignment||"right",c=0,h=[],l=function(){return Math.floor(r).toString().length},d=function(){var n=new i({image:t.image,frameWidth:t.frameWidth,frameHeight:t.frameHeight,animations:{0:{frames:[0]},1:{frames:[1]},2:{frames:[2]},3:{frames:[3]},4:{frames:[4]},5:{frames:[5]},6:{frames:[6]},7:{frames:[7]},8:{frames:[8]},9:{frames:[9]},"-":{frames:[10]}}}),o=a.extend({components:[n],init:function(){c=t.frameWidth}},t.digit||{}),r=new e(o);return r.sprite=n.animation,r},f=function(){var t,e,i,a=r.toString(),f=l(),p=h.length-f;if(0>p)for(t=0;t<Math.abs(p);++t)i=d(),h.push(i),o.attach(i);else if(p>0)for(t=0;t<Math.abs(p);++t)i=h.pop(),o.remove(i);for(t=0;t<h.length;++t)i=h[t],i.position=new n((c+s.x)*t,0),i.sprite.setAnimation(a.substr(t,1));if("right"===u)for(t=0;t<h.length;++t)i=h[t],e=i.position,e.substractFrom(new n((c+s.x)*f-s.x,0));else if("center"===u)for(t=0;t<h.length;++t)i=h[t],e=i.position,e.addTo(new n(((c+s.x)*f-s.x)/-2,0))},p={z:t.z,name:t.name,position:t.position,components:[new i({})]};return a.extend(p,t),o=new e(p).extend({init:function(){f()},setValue:function(t){r=t,f()},getValue:function(){return r},addValue:function(t){r+=t,f()},getDigits:function(){return l()},loopDigits:function(t){var e=0;for(e=0;e<h.length;++e)t(h[e])}})}}),bento.define("bento/gui/togglebutton",["bento","bento/math/vector2","bento/math/rectangle","bento/components/sprite","bento/components/clickable","bento/entity","bento/utils","bento/tween"],function(t,e,n,i,o,r,s){"use strict";return function(n){var a=(t.getViewport(),!0),u=!1,c=new i({image:n.image,frameWidth:n.frameWidth||32,frameHeight:n.frameHeight||32,animations:n.animations||{up:{speed:0,frames:[0]},down:{speed:0,frames:[1]}}}),h=s.extend({z:0,name:"",originRelative:new e(.5,.5),position:new e(0,0),components:[c,new o({onClick:function(){c.animation.setAnimation("down")},onHoldEnter:function(){c.animation.setAnimation("down")},onHoldLeave:function(){c.animation.setAnimation(u?"down":"up")},pointerUp:function(){c.animation.setAnimation(u?"down":"up")},onHoldEnd:function(){a&&(u=u?!1:!0,n.onToggle&&(n.onToggle.apply(l),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx))),c.animation.setAnimation(u?"down":"up"))}})],family:["buttons"],init:function(){}},n),l=new r(h).extend({isToggled:function(){return u},toggle:function(e,i){u=s.isDefined(e)?e:!u,i&&n.onToggle&&(n.onToggle.apply(l),n.sfx&&(t.audio.stopSound(n.sfx),t.audio.playSound(n.sfx))),c.animation.setAnimation(u?"down":"up")}});return s.isDefined(n.active)&&(a=n.active),n.toggled&&(u=!0),c.animation.setAnimation(u?"down":"up"),l}});